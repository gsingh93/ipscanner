NMAP(1)			&nbsp;&nbsp;&nbsp;&nbsp; Nmap Reference Guide		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NMAP(1)<br />
<br />
<br />
<br />
NAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nmap - Network exploration tool and security / port scanner<br />
<br />
SYNOPSIS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nmap [Scan Type...] [Options] {target specification}<br />
<br />
DESCRIPTION<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap ("Network Mapper") is an open source tool for network exploration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and security auditing. It was designed to rapidly scan large networks,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; although it works fine against single hosts. Nmap uses raw IP packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in novel ways to determine what hosts are available on the network,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; what services (application name and version) those hosts are offering,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; what operating systems (and OS versions) they are running, what type of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; packet filters/firewalls are in use, and dozens of other<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; characteristics. While Nmap is commonly used for security audits, many<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; systems and network administrators find it useful for routine tasks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; such as network inventory, managing service upgrade schedules, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; monitoring host or service uptime.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The output from Nmap is a list of scanned targets, with supplemental<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; information on each depending on the options used. Key among that<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; information is the "interesting ports table"..&nbsp;&nbsp;That table lists the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; port number and protocol, service name, and state. The state is either<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; open, filtered, closed, or unfiltered.&nbsp;&nbsp;Open.&nbsp;&nbsp;means that an<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; application on the target machine is listening for connections/packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on that port.&nbsp;&nbsp;Filtered.	 means that a firewall, filter, or other<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; network obstacle is blocking the port so that Nmap cannot tell whether<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; it is open or closed.&nbsp;&nbsp;Closed.&nbsp;&nbsp;ports have no application listening on<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; them, though they could open up at any time. Ports are classified as<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unfiltered.&nbsp;&nbsp;when they are responsive to Nmap's probes, but Nmap cannot<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; determine whether they are open or closed. Nmap reports the state<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; combinations open|filtered.&nbsp;&nbsp;and closed|filtered.&nbsp;&nbsp;when it cannot<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; determine which of the two states describe a port. The port table may<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; also include software version details when version detection has been<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requested. When an IP protocol scan is requested (-sO), Nmap provides<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; information on supported IP protocols rather than listening ports.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; In addition to the interesting ports table, Nmap can provide further<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; information on targets, including reverse DNS names, operating system<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; guesses, device types, and MAC addresses.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A typical Nmap scan is shown in Example 1. The only Nmap arguments used<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in this example are -A, to enable OS and version detection, script<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanning, and traceroute; -T4 for faster execution; and then the two<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target hostnames.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Example 1. A representative Nmap scan<br />
<br />
	&nbsp;&nbsp; # nmap -A -T4 scanme.nmap.org<br />
<br />
	&nbsp;&nbsp; Nmap scan report for scanme.nmap.org (74.207.244.221)<br />
	&nbsp;&nbsp; Host is up (0.029s latency).<br />
	&nbsp;&nbsp; rDNS record for 74.207.244.221: li86-221.members.linode.com<br />
	&nbsp;&nbsp; Not shown: 995 closed ports<br />
	&nbsp;&nbsp; PORT	&nbsp;&nbsp;&nbsp;&nbsp;STATE&nbsp;&nbsp;&nbsp;&nbsp;SERVICE	 VERSION<br />
	&nbsp;&nbsp; 22/tcp&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp; ssh	 OpenSSH 5.3p1 Debian 3ubuntu7 (protocol 2.0)<br />
	&nbsp;&nbsp; | ssh-hostkey: 1024 8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA)<br />
	&nbsp;&nbsp; |_2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)<br />
	&nbsp;&nbsp; 80/tcp&nbsp;&nbsp; open&nbsp;&nbsp;&nbsp;&nbsp; http	 Apache httpd 2.2.14 ((Ubuntu))<br />
	&nbsp;&nbsp; |_http-title: Go ahead and ScanMe!<br />
	&nbsp;&nbsp; 646/tcp&nbsp;&nbsp;filtered ldp<br />
	&nbsp;&nbsp; 1720/tcp filtered H.323/Q.931<br />
	&nbsp;&nbsp; 9929/tcp open&nbsp;&nbsp;&nbsp;&nbsp; nping-echo	 Nping echo<br />
	&nbsp;&nbsp; Device type: general purpose<br />
	&nbsp;&nbsp; Running: Linux 2.6.X<br />
	&nbsp;&nbsp; OS CPE: cpe:/o:linux:linux_kernel:2.6.39<br />
	&nbsp;&nbsp; OS details: Linux 2.6.39<br />
	&nbsp;&nbsp; Network Distance: 11 hops<br />
	&nbsp;&nbsp; Service Info: OS: Linux; CPE: cpe:/o:linux:kernel<br />
<br />
	&nbsp;&nbsp; TRACEROUTE (using port 53/tcp)<br />
	&nbsp;&nbsp; HOP RTT	ADDRESS<br />
	&nbsp;&nbsp; [Cut first 10 hops for brevity]<br />
	&nbsp;&nbsp; 11&nbsp;&nbsp;17.65 ms li86-221.members.linode.com (74.207.244.221)<br />
<br />
	&nbsp;&nbsp; Nmap done: 1 IP address (1 host up) scanned in 14.40 seconds<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The newest version of Nmap can be obtained from http://nmap.org. The<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newest version of this man page is available at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://nmap.org/book/man.html.&nbsp;&nbsp;It is also included as a chapter of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap Network Scanning: The Official Nmap Project Guide to Network<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Discovery and Security Scanning (see http://nmap.org/book/).<br />
<br />
OPTIONS SUMMARY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This options summary is printed when Nmap is run with no arguments, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the latest version is always available at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; https://svn.nmap.org/nmap/docs/nmap.usage.txt. It helps people remember<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the most common options, but is no substitute for the in-depth<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; documentation in the rest of this manual. Some obscure options aren't<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; even included here.<br />
<br />
	&nbsp;&nbsp; Nmap 6.40 ( http://nmap.org )<br />
	&nbsp;&nbsp; Usage: nmap [Scan Type(s)] [Options] {target specification}<br />
	&nbsp;&nbsp; TARGET SPECIFICATION:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; Can pass hostnames, IP addresses, networks, etc.<br />
	&nbsp;&nbsp;&nbsp;&nbsp; Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -iL &lt;inputfilename&gt;: Input from list of hosts/networks<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -iR &lt;num hosts&gt;: Choose random targets<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --exclude &lt;host1[,host2][,host3],...&gt;: Exclude hosts/networks<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --excludefile &lt;exclude_file&gt;: Exclude list from file<br />
	&nbsp;&nbsp; HOST DISCOVERY:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sL: List Scan - simply list targets to scan<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sn: Ping Scan - disable port scan<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -Pn: Treat all hosts as online -- skip host discovery<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery to given ports<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -PO[protocol list]: IP Protocol Ping<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -n/-R: Never do DNS resolution/Always resolve [default: sometimes]<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --dns-servers &lt;serv1[,serv2],...&gt;: Specify custom DNS servers<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --system-dns: Use OS's DNS resolver<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --traceroute: Trace hop path to each host<br />
	&nbsp;&nbsp; SCAN TECHNIQUES:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sU: UDP Scan<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sN/sF/sX: TCP Null, FIN, and Xmas scans<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --scanflags &lt;flags&gt;: Customize TCP scan flags<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sI &lt;zombie host[:probeport]&gt;: Idle scan<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sY/sZ: SCTP INIT/COOKIE-ECHO scans<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sO: IP protocol scan<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -b &lt;FTP relay host&gt;: FTP bounce scan<br />
	&nbsp;&nbsp; PORT SPECIFICATION AND SCAN ORDER:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -p &lt;port ranges&gt;: Only scan specified ports<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -F: Fast mode - Scan fewer ports than the default scan<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -r: Scan ports consecutively - don't randomize<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --top-ports &lt;number&gt;: Scan &lt;number&gt; most common ports<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --port-ratio &lt;ratio&gt;: Scan ports more common than &lt;ratio&gt;<br />
	&nbsp;&nbsp; SERVICE/VERSION DETECTION:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sV: Probe open ports to determine service/version info<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --version-intensity &lt;level&gt;: Set from 0 (light) to 9 (try all probes)<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --version-light: Limit to most likely probes (intensity 2)<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --version-all: Try every single probe (intensity 9)<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --version-trace: Show detailed version scan activity (for debugging)<br />
	&nbsp;&nbsp; SCRIPT SCAN:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -sC: equivalent to --script=default<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --script=&lt;Lua scripts&gt;: &lt;Lua scripts&gt; is a comma separated list of<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directories, script-files or script-categories<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --script-args=&lt;n1=v1,[n2=v2,...]&gt;: provide arguments to scripts<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --script-args-file=filename: provide NSE script args in a file<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --script-trace: Show all data sent and received<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --script-updatedb: Update the script database.<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --script-help=&lt;Lua scripts&gt;: Show help about scripts.<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Lua scripts&gt; is a comma separted list of script-files or<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;script-categories.<br />
	&nbsp;&nbsp; OS DETECTION:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -O: Enable OS detection<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --osscan-limit: Limit OS detection to promising targets<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --osscan-guess: Guess OS more aggressively<br />
	&nbsp;&nbsp; TIMING AND PERFORMANCE:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; Options which take &lt;time&gt; are in seconds, or append 'ms' (milliseconds),<br />
	&nbsp;&nbsp;&nbsp;&nbsp; 's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -T&lt;0-5&gt;: Set timing template (higher is faster)<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --min-hostgroup/max-hostgroup &lt;size&gt;: Parallel host scan group sizes<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --min-parallelism/max-parallelism &lt;numprobes&gt;: Probe parallelization<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout &lt;time&gt;: Specifies<br />
		 probe round trip time.<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --max-retries &lt;tries&gt;: Caps number of port scan probe retransmissions.<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --host-timeout &lt;time&gt;: Give up on target after this long<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --scan-delay/--max-scan-delay &lt;time&gt;: Adjust delay between probes<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --min-rate &lt;number&gt;: Send packets no slower than &lt;number&gt; per second<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --max-rate &lt;number&gt;: Send packets no faster than &lt;number&gt; per second<br />
	&nbsp;&nbsp; FIREWALL/IDS EVASION AND SPOOFING:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -f; --mtu &lt;val&gt;: fragment packets (optionally w/given MTU)<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -D &lt;decoy1,decoy2[,ME],...&gt;: Cloak a scan with decoys<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -S &lt;IP_Address&gt;: Spoof source address<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -e &lt;iface&gt;: Use specified interface<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -g/--source-port &lt;portnum&gt;: Use given port number<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --data-length &lt;num&gt;: Append random data to sent packets<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --ip-options &lt;options&gt;: Send packets with specified ip options<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --ttl &lt;val&gt;: Set IP time-to-live field<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --spoof-mac &lt;mac address/prefix/vendor name&gt;: Spoof your MAC address<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --badsum: Send packets with a bogus TCP/UDP/SCTP checksum<br />
	&nbsp;&nbsp; OUTPUT:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -oN/-oX/-oS/-oG &lt;file&gt;: Output scan in normal, XML, s|&lt;rIpt kIddi3,<br />
		and Grepable format, respectively, to the given filename.<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -oA &lt;basename&gt;: Output in the three major formats at once<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -v: Increase verbosity level (use -vv or more for greater effect)<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -d: Increase debugging level (use -dd or more for greater effect)<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --reason: Display the reason a port is in a particular state<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --open: Only show open (or possibly open) ports<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --packet-trace: Show all packets sent and received<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --iflist: Print host interfaces and routes (for debugging)<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --log-errors: Log errors/warnings to the normal-format output file<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --append-output: Append to rather than clobber specified output files<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --resume &lt;filename&gt;: Resume an aborted scan<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --stylesheet &lt;path/URL&gt;: XSL stylesheet to transform XML output to HTML<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --webxml: Reference stylesheet from Nmap.Org for more portable XML<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --no-stylesheet: Prevent associating of XSL stylesheet w/XML output<br />
	&nbsp;&nbsp; MISC:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -6: Enable IPv6 scanning<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -A: Enable OS detection, version detection, script scanning, and traceroute<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --datadir &lt;dirname&gt;: Specify custom Nmap data file location<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --send-eth/--send-ip: Send using raw ethernet frames or IP packets<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --privileged: Assume that the user is fully privileged<br />
	&nbsp;&nbsp;&nbsp;&nbsp; --unprivileged: Assume the user lacks raw socket privileges<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -V: Print version number<br />
	&nbsp;&nbsp;&nbsp;&nbsp; -h: Print this help summary page.<br />
	&nbsp;&nbsp; EXAMPLES:<br />
	&nbsp;&nbsp;&nbsp;&nbsp; nmap -v -A scanme.nmap.org<br />
	&nbsp;&nbsp;&nbsp;&nbsp; nmap -v -sn 192.168.0.0/16 10.0.0.0/8<br />
	&nbsp;&nbsp;&nbsp;&nbsp; nmap -v -iR 10000 -Pn -p 80<br />
	&nbsp;&nbsp; SEE THE MAN PAGE (http://nmap.org/book/man.html) FOR MORE OPTIONS AND EXAMPLES<br />
<br />
TARGET SPECIFICATION<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Everything on the Nmap command-line that isn't an option (or option<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; argument) is treated as a target host specification. The simplest case<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is to specify a target IP address or hostname for scanning.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sometimes you wish to scan a whole network of adjacent hosts. For this,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap supports CIDR-style.&nbsp;&nbsp;addressing. You can append /numbits to an<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IPv4 address or hostname and Nmap will scan every IP address for which<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the first numbits are the same as for the reference IP or hostname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; given. For example, 192.168.10.0/24 would scan the 256 hosts between<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.10.0 (binary: 11000000 10101000 00001010 00000000) and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.10.255 (binary: 11000000 10101000 00001010 11111111),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inclusive.&nbsp;&nbsp;192.168.10.40/24 would scan exactly the same targets. Given<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; that the host scanme.nmap.org.&nbsp;&nbsp;is at the IP address 64.13.134.52, the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specification scanme.nmap.org/16 would scan the 65,536 IP addresses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; between 64.13.0.0 and 64.13.255.255. The smallest allowed value is /0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; which targets the whole Internet. The largest value is /32, which scans<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; just the named host or IP address because all address bits are fixed.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CIDR notation is short but not always flexible enough. For example, you<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; might want to scan 192.168.0.0/16 but skip any IPs ending with .0 or<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .255 because they may be used as subnet network and broadcast<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; addresses. Nmap supports this through octet range addressing. Rather<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; than specify a normal IP address, you can specify a comma-separated<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list of numbers or ranges for each octet. For example,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.0-255.1-254 will skip all addresses in the range that end in .0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or .255, and 192.168.3-5,7.1 will scan the four addresses 192.168.3.1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.4.1, 192.168.5.1, and 192.168.7.1. Either side of a range may<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; be omitted; the default values are 0 on the left and 255 on the right.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Using - by itself is the same as 0-255, but remember to use 0- in the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; first octet so the target specification doesn't look like a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; command-line option. Ranges need not be limited to the final octets:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the specifier 0-255.0-255.13.37 will perform an Internet-wide scan for<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; all IP addresses ending in 13.37. This sort of broad sampling can be<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; useful for Internet surveys and research.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IPv6 addresses can only be specified by their fully qualified IPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; address or hostname. CIDR and octet ranges aren't yet supported for<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IPv6.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IPv6 addresses with non-global scope need to have a zone ID suffix. On<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Unix systems, this is a percent sign followed by an interface name; a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; complete address might be fe80::a8bb:ccff:fedd:eeff%eth0. On Windows,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; use an interface index number in place of an interface name:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fe80::a8bb:ccff:fedd:eeff%1. You can see a list of interface indexes by<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; running the command netsh.exe interface ipv6 show interface.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap accepts multiple host specifications on the command line, and they<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; don't need to be the same type. The command nmap scanme.nmap.org<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.0.0/8 10.0.0,1,3-7.- does what you would expect.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While targets are usually specified on the command lines, the following<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; options are also available to control target selection:<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -iL inputfilename (Input from list) .<br />
	&nbsp;&nbsp; Reads target specifications from inputfilename. Passing a huge list<br />
	&nbsp;&nbsp; of hosts is often awkward on the command line, yet it is a common<br />
	&nbsp;&nbsp; desire. For example, your DHCP server might export a list of 10,000<br />
	&nbsp;&nbsp; current leases that you wish to scan. Or maybe you want to scan all<br />
	&nbsp;&nbsp; IP addresses except for those to locate hosts using unauthorized<br />
	&nbsp;&nbsp; static IP addresses. Simply generate the list of hosts to scan and<br />
	&nbsp;&nbsp; pass that filename to Nmap as an argument to the -iL option.<br />
	&nbsp;&nbsp; Entries can be in any of the formats accepted by Nmap on the<br />
	&nbsp;&nbsp; command line (IP address, hostname, CIDR, IPv6, or octet ranges).<br />
	&nbsp;&nbsp; Each entry must be separated by one or more spaces, tabs, or<br />
	&nbsp;&nbsp; newlines. You can specify a hyphen (-) as the filename if you want<br />
	&nbsp;&nbsp; Nmap to read hosts from standard input rather than an actual file.<br />
<br />
	&nbsp;&nbsp; The input file may contain comments that start with # and extend to<br />
	&nbsp;&nbsp; the end of the line.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -iR num hosts (Choose random targets) .<br />
	&nbsp;&nbsp; For Internet-wide surveys and other research, you may want to<br />
	&nbsp;&nbsp; choose targets at random. The num hosts argument tells Nmap how<br />
	&nbsp;&nbsp; many IPs to generate. Undesirable IPs such as those in certain<br />
	&nbsp;&nbsp; private, multicast, or unallocated address ranges are automatically<br />
	&nbsp;&nbsp; skipped. The argument 0 can be specified for a never-ending scan.<br />
	&nbsp;&nbsp; Keep in mind that some network administrators bristle at<br />
	&nbsp;&nbsp; unauthorized scans of their networks and may complain. Use this<br />
	&nbsp;&nbsp; option at your own risk! If you find yourself really bored one<br />
	&nbsp;&nbsp; rainy afternoon, try the command nmap -Pn -sS -p 80 -iR 0 --open.<br />
	&nbsp;&nbsp; to locate random web servers for browsing.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --exclude host1[,host2[,...]] (Exclude hosts/networks) .<br />
	&nbsp;&nbsp; Specifies a comma-separated list of targets to be excluded from the<br />
	&nbsp;&nbsp; scan even if they are part of the overall network range you<br />
	&nbsp;&nbsp; specify. The list you pass in uses normal Nmap syntax, so it can<br />
	&nbsp;&nbsp; include hostnames, CIDR netblocks, octet ranges, etc. This can be<br />
	&nbsp;&nbsp; useful when the network you wish to scan includes untouchable<br />
	&nbsp;&nbsp; mission-critical servers, systems that are known to react adversely<br />
	&nbsp;&nbsp; to port scans, or subnets administered by other people.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --excludefile exclude_file (Exclude list from file) .<br />
	&nbsp;&nbsp; This offers the same functionality as the --exclude option, except<br />
	&nbsp;&nbsp; that the excluded targets are provided in a newline-, space-, or<br />
	&nbsp;&nbsp; tab-delimited exclude_file rather than on the command line.<br />
<br />
	&nbsp;&nbsp; The exclude file may contain comments that start with # and extend<br />
	&nbsp;&nbsp; to the end of the line.<br />
<br />
HOST DISCOVERY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One of the very first steps in any network reconnaissance mission is to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reduce a (sometimes huge) set of IP ranges into a list of active or<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; interesting hosts. Scanning every port of every single IP address is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; slow and usually unnecessary. Of course what makes a host interesting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; depends greatly on the scan purposes. Network administrators may only<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; be interested in hosts running a certain service, while security<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; auditors may care about every single device with an IP address. An<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; administrator may be comfortable using just an ICMP ping to locate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hosts on his internal network, while an external penetration tester may<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; use a diverse set of dozens of probes in an attempt to evade firewall<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; restrictions.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Because host discovery needs are so diverse, Nmap offers a wide variety<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; of options for customizing the techniques used. Host discovery is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sometimes called ping scan, but it goes well beyond the simple ICMP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo request packets associated with the ubiquitous ping tool. Users<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; can skip the ping step entirely with a list scan (-sL) or by disabling<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ping (-Pn), or engage the network with arbitrary combinations of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multi-port TCP SYN/ACK, UDP, SCTP INIT and ICMP probes. The goal of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; these probes is to solicit responses which demonstrate that an IP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; address is actually active (is being used by a host or network device).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; On many networks, only a small percentage of IP addresses are active at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; any given time. This is particularly common with private address space<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; such as 10.0.0.0/8. That network has 16 million IPs, but I have seen it<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; used by companies with less than a thousand machines. Host discovery<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; can find those machines in a sparsely allocated sea of IP addresses.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If no host discovery options are given, Nmap sends an ICMP echo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request, a TCP SYN packet to port 443, a TCP ACK packet to port 80, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; an ICMP timestamp request. (For IPv6, the ICMP timestamp request is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; omitted because it is not part of ICMPv6.) These defaults are<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; equivalent to the -PE -PS443 -PA80 -PP options. The exceptions to this<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; are the ARP (for IPv4) and Neighbor Discovery.&nbsp;&nbsp;(for IPv6) scans which<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; are used for any targets on a local ethernet network. For unprivileged<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Unix shell users, the default probes are a SYN packet to ports 80 and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 443 using the connect system call..&nbsp;&nbsp;This host discovery is often<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sufficient when scanning local networks, but a more comprehensive set<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; of discovery probes is recommended for security auditing.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The -P* options (which select ping types) can be combined. You can<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; increase your odds of penetrating strict firewalls by sending many<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; probe types using different TCP ports/flags and ICMP codes. Also note<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; that ARP/Neighbor Discovery (-PR).&nbsp;&nbsp;is done by default against targets<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on a local ethernet network even if you specify other -P* options,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; because it is almost always faster and more effective.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; By default, Nmap does host discovery and then performs a port scan<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; against each host it determines is online. This is true even if you<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specify non-default host discovery types such as UDP probes (-PU). Read<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; about the -sn option to learn how to perform only host discovery, or<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; use -Pn to skip host discovery and port scan all target hosts. The<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; following options control host discovery:<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sL (List Scan) .<br />
	&nbsp;&nbsp; The list scan is a degenerate form of host discovery that simply<br />
	&nbsp;&nbsp; lists each host of the network(s) specified, without sending any<br />
	&nbsp;&nbsp; packets to the target hosts. By default, Nmap still does<br />
	&nbsp;&nbsp; reverse-DNS resolution on the hosts to learn their names. It is<br />
	&nbsp;&nbsp; often surprising how much useful information simple hostnames give<br />
	&nbsp;&nbsp; out. For example, fw.chi is the name of one company's Chicago<br />
	&nbsp;&nbsp; firewall.&nbsp;&nbsp;Nmap also reports the total number of IP addresses at<br />
	&nbsp;&nbsp; the end. The list scan is a good sanity check to ensure that you<br />
	&nbsp;&nbsp; have proper IP addresses for your targets. If the hosts sport<br />
	&nbsp;&nbsp; domain names you do not recognize, it is worth investigating<br />
	&nbsp;&nbsp; further to prevent scanning the wrong company's network.<br />
<br />
	&nbsp;&nbsp; Since the idea is to simply print a list of target hosts, options<br />
	&nbsp;&nbsp; for higher level functionality such as port scanning, OS detection,<br />
	&nbsp;&nbsp; or ping scanning cannot be combined with this. If you wish to<br />
	&nbsp;&nbsp; disable ping scanning while still performing such higher level<br />
	&nbsp;&nbsp; functionality, read up on the -Pn (skip ping) option.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sn (No port scan) .<br />
	&nbsp;&nbsp; This option tells Nmap not to do a port scan after host discovery,<br />
	&nbsp;&nbsp; and only print out the available hosts that responded to the scan.<br />
	&nbsp;&nbsp; This is often known as a "ping scan", but you can also request that<br />
	&nbsp;&nbsp; traceroute and NSE host scripts be run. This is by default one step<br />
	&nbsp;&nbsp; more intrusive than the list scan, and can often be used for the<br />
	&nbsp;&nbsp; same purposes. It allows light reconnaissance of a target network<br />
	&nbsp;&nbsp; without attracting much attention. Knowing how many hosts are up is<br />
	&nbsp;&nbsp; more valuable to attackers than the list provided by list scan of<br />
	&nbsp;&nbsp; every single IP and host name.<br />
<br />
	&nbsp;&nbsp; Systems administrators often find this option valuable as well. It<br />
	&nbsp;&nbsp; can easily be used to count available machines on a network or<br />
	&nbsp;&nbsp; monitor server availability. This is often called a ping sweep, and<br />
	&nbsp;&nbsp; is more reliable than pinging the broadcast address because many<br />
	&nbsp;&nbsp; hosts do not reply to broadcast queries.<br />
<br />
	&nbsp;&nbsp; The default host discovery done with -sn consists of an ICMP echo<br />
	&nbsp;&nbsp; request, TCP SYN to port 443, TCP ACK to port 80, and an ICMP<br />
	&nbsp;&nbsp; timestamp request by default. When executed by an unprivileged<br />
	&nbsp;&nbsp; user, only SYN packets are sent (using a connect call) to ports 80<br />
	&nbsp;&nbsp; and 443 on the target. When a privileged user tries to scan targets<br />
	&nbsp;&nbsp; on a local ethernet network, ARP requests are used unless --send-ip<br />
	&nbsp;&nbsp; was specified. The -sn option can be combined with any of the<br />
	&nbsp;&nbsp; discovery probe types (the -P* options, excluding -Pn) for greater<br />
	&nbsp;&nbsp; flexibility. If any of those probe type and port number options are<br />
	&nbsp;&nbsp; used, the default probes are overridden. When strict firewalls are<br />
	&nbsp;&nbsp; in place between the source host running Nmap and the target<br />
	&nbsp;&nbsp; network, using those advanced techniques is recommended. Otherwise<br />
	&nbsp;&nbsp; hosts could be missed when the firewall drops probes or their<br />
	&nbsp;&nbsp; responses.<br />
<br />
	&nbsp;&nbsp; In previous releases of Nmap, -sn was known as -sP..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Pn (No ping) .<br />
	&nbsp;&nbsp; This option skips the Nmap discovery stage altogether. Normally,<br />
	&nbsp;&nbsp; Nmap uses this stage to determine active machines for heavier<br />
	&nbsp;&nbsp; scanning. By default, Nmap only performs heavy probing such as port<br />
	&nbsp;&nbsp; scans, version detection, or OS detection against hosts that are<br />
	&nbsp;&nbsp; found to be up. Disabling host discovery with -Pn causes Nmap to<br />
	&nbsp;&nbsp; attempt the requested scanning functions against every target IP<br />
	&nbsp;&nbsp; address specified. So if a class B target address space (/16) is<br />
	&nbsp;&nbsp; specified on the command line, all 65,536 IP addresses are scanned.<br />
	&nbsp;&nbsp; Proper host discovery is skipped as with the list scan, but instead<br />
	&nbsp;&nbsp; of stopping and printing the target list, Nmap continues to perform<br />
	&nbsp;&nbsp; requested functions as if each target IP is active. To skip ping<br />
	&nbsp;&nbsp; scan and port scan, while still allowing NSE to run, use the two<br />
	&nbsp;&nbsp; options -Pn -sn together.<br />
<br />
	&nbsp;&nbsp; For machines on a local ethernet network, ARP scanning will still<br />
	&nbsp;&nbsp; be performed (unless --disable-arp-ping or --send-ip is specified)<br />
	&nbsp;&nbsp; because Nmap needs MAC addresses to further scan target hosts. In<br />
	&nbsp;&nbsp; previous versions of Nmap, -Pn was -P0.&nbsp;&nbsp;and -PN..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -PS port list (TCP SYN Ping) .<br />
	&nbsp;&nbsp; This option sends an empty TCP packet with the SYN flag set. The<br />
	&nbsp;&nbsp; default destination port is 80 (configurable at compile time by<br />
	&nbsp;&nbsp; changing DEFAULT_TCP_PROBE_PORT_SPEC.&nbsp;&nbsp;in nmap.h)..	Alternate<br />
	&nbsp;&nbsp; ports can be specified as a parameter. The syntax is the same as<br />
	&nbsp;&nbsp; for the -p except that port type specifiers like T: are not<br />
	&nbsp;&nbsp; allowed. Examples are -PS22 and -PS22-25,80,113,1050,35000. Note<br />
	&nbsp;&nbsp; that there can be no space between -PS and the port list. If<br />
	&nbsp;&nbsp; multiple probes are specified they will be sent in parallel.<br />
<br />
	&nbsp;&nbsp; The SYN flag suggests to the remote system that you are attempting<br />
	&nbsp;&nbsp; to establish a connection. Normally the destination port will be<br />
	&nbsp;&nbsp; closed, and a RST (reset) packet sent back. If the port happens to<br />
	&nbsp;&nbsp; be open, the target will take the second step of a TCP<br />
	&nbsp;&nbsp; three-way-handshake.	 by responding with a SYN/ACK TCP packet. The<br />
	&nbsp;&nbsp; machine running Nmap then tears down the nascent connection by<br />
	&nbsp;&nbsp; responding with a RST rather than sending an ACK packet which would<br />
	&nbsp;&nbsp; complete the three-way-handshake and establish a full connection.<br />
	&nbsp;&nbsp; The RST packet is sent by the kernel of the machine running Nmap in<br />
	&nbsp;&nbsp; response to the unexpected SYN/ACK, not by Nmap itself.<br />
<br />
	&nbsp;&nbsp; Nmap does not care whether the port is open or closed. Either the<br />
	&nbsp;&nbsp; RST or SYN/ACK response discussed previously tell Nmap that the<br />
	&nbsp;&nbsp; host is available and responsive.<br />
<br />
	&nbsp;&nbsp; On Unix boxes, only the privileged user root.&nbsp;&nbsp;is generally able to<br />
	&nbsp;&nbsp; send and receive raw TCP packets..&nbsp;&nbsp;For unprivileged users, a<br />
	&nbsp;&nbsp; workaround is automatically employed.&nbsp;&nbsp;whereby the connect system<br />
	&nbsp;&nbsp; call is initiated against each target port. This has the effect of<br />
	&nbsp;&nbsp; sending a SYN packet to the target host, in an attempt to establish<br />
	&nbsp;&nbsp; a connection. If connect returns with a quick success or an<br />
	&nbsp;&nbsp; ECONNREFUSED failure, the underlying TCP stack must have received a<br />
	&nbsp;&nbsp; SYN/ACK or RST and the host is marked available. If the connection<br />
	&nbsp;&nbsp; attempt is left hanging until a timeout is reached, the host is<br />
	&nbsp;&nbsp; marked as down.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -PA port list (TCP ACK Ping) .<br />
	&nbsp;&nbsp; The TCP ACK ping is quite similar to the just-discussed SYN ping.<br />
	&nbsp;&nbsp; The difference, as you could likely guess, is that the TCP ACK flag<br />
	&nbsp;&nbsp; is set instead of the SYN flag. Such an ACK packet purports to be<br />
	&nbsp;&nbsp; acknowledging data over an established TCP connection, but no such<br />
	&nbsp;&nbsp; connection exists. So remote hosts should always respond with a RST<br />
	&nbsp;&nbsp; packet, disclosing their existence in the process.<br />
<br />
	&nbsp;&nbsp; The -PA option uses the same default port as the SYN probe (80) and<br />
	&nbsp;&nbsp; can also take a list of destination ports in the same format. If an<br />
	&nbsp;&nbsp; unprivileged user tries this, the connect workaround discussed<br />
	&nbsp;&nbsp; previously is used. This workaround is imperfect because connect is<br />
	&nbsp;&nbsp; actually sending a SYN packet rather than an ACK.<br />
<br />
	&nbsp;&nbsp; The reason for offering both SYN and ACK ping probes is to maximize<br />
	&nbsp;&nbsp; the chances of bypassing firewalls. Many administrators configure<br />
	&nbsp;&nbsp; routers and other simple firewalls to block incoming SYN packets<br />
	&nbsp;&nbsp; except for those destined for public services like the company web<br />
	&nbsp;&nbsp; site or mail server. This prevents other incoming connections to<br />
	&nbsp;&nbsp; the organization, while allowing users to make unobstructed<br />
	&nbsp;&nbsp; outgoing connections to the Internet. This non-stateful approach<br />
	&nbsp;&nbsp; takes up few resources on the firewall/router and is widely<br />
	&nbsp;&nbsp; supported by hardware and software filters. The Linux<br />
	&nbsp;&nbsp; Netfilter/iptables.	firewall software offers the --syn convenience<br />
	&nbsp;&nbsp; option to implement this stateless approach. When stateless<br />
	&nbsp;&nbsp; firewall rules such as this are in place, SYN ping probes (-PS) are<br />
	&nbsp;&nbsp; likely to be blocked when sent to closed target ports. In such<br />
	&nbsp;&nbsp; cases, the ACK probe shines as it cuts right through these rules.<br />
<br />
	&nbsp;&nbsp; Another common type of firewall uses stateful rules that drop<br />
	&nbsp;&nbsp; unexpected packets. This feature was initially found mostly on<br />
	&nbsp;&nbsp; high-end firewalls, though it has become much more common over the<br />
	&nbsp;&nbsp; years. The Linux Netfilter/iptables system supports this through<br />
	&nbsp;&nbsp; the --state option, which categorizes packets based on connection<br />
	&nbsp;&nbsp; state. A SYN probe is more likely to work against such a system, as<br />
	&nbsp;&nbsp; unexpected ACK packets are generally recognized as bogus and<br />
	&nbsp;&nbsp; dropped. A solution to this quandary is to send both SYN and ACK<br />
	&nbsp;&nbsp; probes by specifying -PS and -PA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -PU port list (UDP Ping) .<br />
	&nbsp;&nbsp; Another host discovery option is the UDP ping, which sends a UDP<br />
	&nbsp;&nbsp; packet to the given ports. For most ports, the packet will be<br />
	&nbsp;&nbsp; empty, though for a few a protocol-specific payload will be sent<br />
	&nbsp;&nbsp; that is more likely to get a response..&nbsp;&nbsp;The --data-length.	option<br />
	&nbsp;&nbsp; can be used to send a fixed-length random payload to every port or<br />
	&nbsp;&nbsp; (if you specify a value of 0) to disable payloads. You can also<br />
	&nbsp;&nbsp; disable payloads by specifying --data-length 0.<br />
<br />
	&nbsp;&nbsp; The port list takes the same format as with the previously<br />
	&nbsp;&nbsp; discussed -PS and -PA options. If no ports are specified, the<br />
	&nbsp;&nbsp; default is 40125..&nbsp;&nbsp;This default can be configured at compile-time<br />
	&nbsp;&nbsp; by changing DEFAULT_UDP_PROBE_PORT_SPEC.&nbsp;&nbsp;in nmap.h..&nbsp;&nbsp;A highly<br />
	&nbsp;&nbsp; uncommon port is used by default because sending to open ports is<br />
	&nbsp;&nbsp; often undesirable for this particular scan type.<br />
<br />
	&nbsp;&nbsp; Upon hitting a closed port on the target machine, the UDP probe<br />
	&nbsp;&nbsp; should elicit an ICMP port unreachable packet in return. This<br />
	&nbsp;&nbsp; signifies to Nmap that the machine is up and available. Many other<br />
	&nbsp;&nbsp; types of ICMP errors, such as host/network unreachables or TTL<br />
	&nbsp;&nbsp; exceeded are indicative of a down or unreachable host. A lack of<br />
	&nbsp;&nbsp; response is also interpreted this way. If an open port is reached,<br />
	&nbsp;&nbsp; most services simply ignore the empty packet and fail to return any<br />
	&nbsp;&nbsp; response. This is why the default probe port is 40125, which is<br />
	&nbsp;&nbsp; highly unlikely to be in use. A few services, such as the Character<br />
	&nbsp;&nbsp; Generator (chargen) protocol, will respond to an empty UDP packet,<br />
	&nbsp;&nbsp; and thus disclose to Nmap that the machine is available.<br />
<br />
	&nbsp;&nbsp; The primary advantage of this scan type is that it bypasses<br />
	&nbsp;&nbsp; firewalls and filters that only screen TCP. For example, I once<br />
	&nbsp;&nbsp; owned a Linksys BEFW11S4 wireless broadband router. The external<br />
	&nbsp;&nbsp; interface of this device filtered all TCP ports by default, but UDP<br />
	&nbsp;&nbsp; probes would still elicit port unreachable messages and thus give<br />
	&nbsp;&nbsp; away the device.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -PY port list (SCTP INIT Ping) .<br />
	&nbsp;&nbsp; This option sends an SCTP packet containing a minimal INIT chunk.<br />
	&nbsp;&nbsp; The default destination port is 80 (configurable at compile time by<br />
	&nbsp;&nbsp; changing DEFAULT_SCTP_PROBE_PORT_SPEC.&nbsp;&nbsp;in nmap.h). Alternate ports<br />
	&nbsp;&nbsp; can be specified as a parameter. The syntax is the same as for the<br />
	&nbsp;&nbsp; -p except that port type specifiers like S: are not allowed.<br />
	&nbsp;&nbsp; Examples are -PY22 and -PY22,80,179,5060. Note that there can be no<br />
	&nbsp;&nbsp; space between -PY and the port list. If multiple probes are<br />
	&nbsp;&nbsp; specified they will be sent in parallel.<br />
<br />
	&nbsp;&nbsp; The INIT chunk suggests to the remote system that you are<br />
	&nbsp;&nbsp; attempting to establish an association. Normally the destination<br />
	&nbsp;&nbsp; port will be closed, and an ABORT chunk will be sent back. If the<br />
	&nbsp;&nbsp; port happens to be open, the target will take the second step of an<br />
	&nbsp;&nbsp; SCTP four-way-handshake.&nbsp;&nbsp;by responding with an INIT-ACK chunk. If<br />
	&nbsp;&nbsp; the machine running Nmap has a functional SCTP stack, then it tears<br />
	&nbsp;&nbsp; down the nascent association by responding with an ABORT chunk<br />
	&nbsp;&nbsp; rather than sending a COOKIE-ECHO chunk which would be the next<br />
	&nbsp;&nbsp; step in the four-way-handshake. The ABORT packet is sent by the<br />
	&nbsp;&nbsp; kernel of the machine running Nmap in response to the unexpected<br />
	&nbsp;&nbsp; INIT-ACK, not by Nmap itself.<br />
<br />
	&nbsp;&nbsp; Nmap does not care whether the port is open or closed. Either the<br />
	&nbsp;&nbsp; ABORT or INIT-ACK response discussed previously tell Nmap that the<br />
	&nbsp;&nbsp; host is available and responsive.<br />
<br />
	&nbsp;&nbsp; On Unix boxes, only the privileged user root.&nbsp;&nbsp;is generally able to<br />
	&nbsp;&nbsp; send and receive raw SCTP packets..	Using SCTP INIT Pings is<br />
	&nbsp;&nbsp; currently not possible for unprivileged users..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -PE; -PP; -PM (ICMP Ping Types) .<br />
	&nbsp;&nbsp; In addition to the unusual TCP, UDP and SCTP host discovery types<br />
	&nbsp;&nbsp; discussed previously, Nmap can send the standard packets sent by<br />
	&nbsp;&nbsp; the ubiquitous ping program. Nmap sends an ICMP type 8 (echo<br />
	&nbsp;&nbsp; request) packet to the target IP addresses, expecting a type 0<br />
	&nbsp;&nbsp; (echo reply) in return from available hosts..&nbsp;&nbsp;Unfortunately for<br />
	&nbsp;&nbsp; network explorers, many hosts and firewalls now block these<br />
	&nbsp;&nbsp; packets, rather than responding as required by RFC 1122[2]..	 For<br />
	&nbsp;&nbsp; this reason, ICMP-only scans are rarely reliable enough against<br />
	&nbsp;&nbsp; unknown targets over the Internet. But for system administrators<br />
	&nbsp;&nbsp; monitoring an internal network, they can be a practical and<br />
	&nbsp;&nbsp; efficient approach. Use the -PE option to enable this echo request<br />
	&nbsp;&nbsp; behavior.<br />
<br />
	&nbsp;&nbsp; While echo request is the standard ICMP ping query, Nmap does not<br />
	&nbsp;&nbsp; stop there. The ICMP standards (RFC 792[3].	and RFC 950[4].	 "a<br />
	&nbsp;&nbsp; host SHOULD NOT implement these messages". Timestamp and address<br />
	&nbsp;&nbsp; mask queries can be sent with the -PP and -PM options,<br />
	&nbsp;&nbsp; respectively. A timestamp reply (ICMP code 14) or address mask<br />
	&nbsp;&nbsp; reply (code 18) discloses that the host is available. These two<br />
	&nbsp;&nbsp; queries can be valuable when administrators specifically block echo<br />
	&nbsp;&nbsp; request packets while forgetting that other ICMP queries can be<br />
	&nbsp;&nbsp; used for the same purpose.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -PO protocol list (IP Protocol Ping) .<br />
	&nbsp;&nbsp; One of the newer host discovery options is the IP protocol ping,<br />
	&nbsp;&nbsp; which sends IP packets with the specified protocol number set in<br />
	&nbsp;&nbsp; their IP header. The protocol list takes the same format as do port<br />
	&nbsp;&nbsp; lists in the previously discussed TCP, UDP and SCTP host discovery<br />
	&nbsp;&nbsp; options. If no protocols are specified, the default is to send<br />
	&nbsp;&nbsp; multiple IP packets for ICMP (protocol 1), IGMP (protocol 2), and<br />
	&nbsp;&nbsp; IP-in-IP (protocol 4). The default protocols can be configured at<br />
	&nbsp;&nbsp; compile-time by changing DEFAULT_PROTO_PROBE_PORT_SPEC.&nbsp;&nbsp;in nmap.h.<br />
	&nbsp;&nbsp; Note that for the ICMP, IGMP, TCP (protocol 6), UDP (protocol 17)<br />
	&nbsp;&nbsp; and SCTP (protocol 132), the packets are sent with the proper<br />
	&nbsp;&nbsp; protocol headers.&nbsp;&nbsp;while other protocols are sent with no<br />
	&nbsp;&nbsp; additional data beyond the IP header (unless the --data-length.<br />
	&nbsp;&nbsp; option is specified).<br />
<br />
	&nbsp;&nbsp; This host discovery method looks for either responses using the<br />
	&nbsp;&nbsp; same protocol as a probe, or ICMP protocol unreachable messages<br />
	&nbsp;&nbsp; which signify that the given protocol isn't supported on the<br />
	&nbsp;&nbsp; destination host. Either type of response signifies that the target<br />
	&nbsp;&nbsp; host is alive.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -PR (ARP Ping) .<br />
	&nbsp;&nbsp; One of the most common Nmap usage scenarios is to scan an ethernet<br />
	&nbsp;&nbsp; LAN. On most LANs, especially those using private address ranges<br />
	&nbsp;&nbsp; specified by RFC 1918[5], the vast majority of IP addresses are<br />
	&nbsp;&nbsp; unused at any given time. When Nmap tries to send a raw IP packet<br />
	&nbsp;&nbsp; such as an ICMP echo request, the operating system must determine<br />
	&nbsp;&nbsp; the destination hardware (ARP) address corresponding to the target<br />
	&nbsp;&nbsp; IP so that it can properly address the ethernet frame. This is<br />
	&nbsp;&nbsp; often slow and problematic, since operating systems weren't written<br />
	&nbsp;&nbsp; with the expectation that they would need to do millions of ARP<br />
	&nbsp;&nbsp; requests against unavailable hosts in a short time period.<br />
<br />
	&nbsp;&nbsp; ARP scan puts Nmap and its optimized algorithms in charge of ARP<br />
	&nbsp;&nbsp; requests. And if it gets a response back, Nmap doesn't even need to<br />
	&nbsp;&nbsp; worry about the IP-based ping packets since it already knows the<br />
	&nbsp;&nbsp; host is up. This makes ARP scan much faster and more reliable than<br />
	&nbsp;&nbsp; IP-based scans. So it is done by default when scanning ethernet<br />
	&nbsp;&nbsp; hosts that Nmap detects are on a local ethernet network. Even if<br />
	&nbsp;&nbsp; different ping types (such as -PE or -PS) are specified, Nmap uses<br />
	&nbsp;&nbsp; ARP instead for any of the targets which are on the same LAN. If<br />
	&nbsp;&nbsp; you absolutely don't want to do an ARP scan, specify<br />
	&nbsp;&nbsp; --disable-arp-ping.<br />
<br />
	&nbsp;&nbsp; For IPv6 (-6 option), -PR uses ICMPv6 Neighbor Discovery instead of<br />
	&nbsp;&nbsp; ARP. Neighbor Discovery, defined in RFC 4861, can be seen as the<br />
	&nbsp;&nbsp; IPv6 equivalent of ARP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --disable-arp-ping (No ARP or ND Ping) .<br />
	&nbsp;&nbsp; Nmap normally does ARP or IPv6 Neighbor Discovery (ND) discovery of<br />
	&nbsp;&nbsp; locally connected ethernet hosts, even if other host discovery<br />
	&nbsp;&nbsp; options such as -Pn or -PE are used. To disable this implicit<br />
	&nbsp;&nbsp; behavior, use the --disable-arp-ping option.<br />
<br />
	&nbsp;&nbsp; The default behavior is normally faster, but this option is useful<br />
	&nbsp;&nbsp; on networks using proxy ARP, in which a router speculatively<br />
	&nbsp;&nbsp; replies to all ARP requests, making every target appear to be up<br />
	&nbsp;&nbsp; according to ARP scan.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --traceroute (Trace path to host) .<br />
	&nbsp;&nbsp; Traceroutes are performed post-scan using information from the scan<br />
	&nbsp;&nbsp; results to determine the port and protocol most likely to reach the<br />
	&nbsp;&nbsp; target. It works with all scan types except connect scans (-sT) and<br />
	&nbsp;&nbsp; idle scans (-sI). All traces use Nmap's dynamic timing model and<br />
	&nbsp;&nbsp; are performed in parallel.<br />
<br />
	&nbsp;&nbsp; Traceroute works by sending packets with a low TTL (time-to-live)<br />
	&nbsp;&nbsp; in an attempt to elicit ICMP Time Exceeded messages from<br />
	&nbsp;&nbsp; intermediate hops between the scanner and the target host. Standard<br />
	&nbsp;&nbsp; traceroute implementations start with a TTL of 1 and increment the<br />
	&nbsp;&nbsp; TTL until the destination host is reached. Nmap's traceroute starts<br />
	&nbsp;&nbsp; with a high TTL and then decrements the TTL until it reaches zero.<br />
	&nbsp;&nbsp; Doing it backwards lets Nmap employ clever caching algorithms to<br />
	&nbsp;&nbsp; speed up traces over multiple hosts. On average Nmap sends 510<br />
	&nbsp;&nbsp; fewer packets per host, depending on network conditions. If a<br />
	&nbsp;&nbsp; single subnet is being scanned (i.e. 192.168.0.0/24) Nmap may only<br />
	&nbsp;&nbsp; have to send two packets to most hosts.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -n (No DNS resolution) .<br />
	&nbsp;&nbsp; Tells Nmap to never do reverse DNS resolution on the active IP<br />
	&nbsp;&nbsp; addresses it finds. Since DNS can be slow even with Nmap's built-in<br />
	&nbsp;&nbsp; parallel stub resolver, this option can slash scanning times.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -R (DNS resolution for all targets) .<br />
	&nbsp;&nbsp; Tells Nmap to always do reverse DNS resolution on the target IP<br />
	&nbsp;&nbsp; addresses. Normally reverse DNS is only performed against<br />
	&nbsp;&nbsp; responsive (online) hosts.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --system-dns (Use system DNS resolver) .<br />
	&nbsp;&nbsp; By default, Nmap resolves IP addresses by sending queries directly<br />
	&nbsp;&nbsp; to the name servers configured on your host and then listening for<br />
	&nbsp;&nbsp; responses. Many requests (often dozens) are performed in parallel<br />
	&nbsp;&nbsp; to improve performance. Specify this option to use your system<br />
	&nbsp;&nbsp; resolver instead (one IP at a time via the getnameinfo call). This<br />
	&nbsp;&nbsp; is slower and rarely useful unless you find a bug in the Nmap<br />
	&nbsp;&nbsp; parallel resolver (please let us know if you do). The system<br />
	&nbsp;&nbsp; resolver is always used for IPv6 scans.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --dns-servers server1[,server2[,...]]&nbsp;&nbsp;(Servers to use for reverse DNS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; queries) .<br />
	&nbsp;&nbsp; By default, Nmap determines your DNS servers (for rDNS resolution)<br />
	&nbsp;&nbsp; from your resolv.conf file (Unix) or the Registry (Win32).<br />
	&nbsp;&nbsp; Alternatively, you may use this option to specify alternate<br />
	&nbsp;&nbsp; servers. This option is not honored if you are using --system-dns<br />
	&nbsp;&nbsp; or an IPv6 scan. Using multiple DNS servers is often faster,<br />
	&nbsp;&nbsp; especially if you choose authoritative servers for your target IP<br />
	&nbsp;&nbsp; space. This option can also improve stealth, as your requests can<br />
	&nbsp;&nbsp; be bounced off just about any recursive DNS server on the Internet.<br />
<br />
	&nbsp;&nbsp; This option also comes in handy when scanning private networks.<br />
	&nbsp;&nbsp; Sometimes only a few name servers provide proper rDNS information,<br />
	&nbsp;&nbsp; and you may not even know where they are. You can scan the network<br />
	&nbsp;&nbsp; for port 53 (perhaps with version detection), then try Nmap list<br />
	&nbsp;&nbsp; scans (-sL) specifying each name server one at a time with<br />
	&nbsp;&nbsp; --dns-servers until you find one which works.<br />
<br />
PORT SCANNING BASICS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While Nmap has grown in functionality over the years, it began as an<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; efficient port scanner, and that remains its core function. The simple<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; command nmap target scans 1,000 TCP ports on the host target. While<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; many port scanners have traditionally lumped all ports into the open or<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; closed states, Nmap is much more granular. It divides ports into six<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; states: open, closed, filtered, unfiltered, open|filtered, or<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; closed|filtered.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; These states are not intrinsic properties of the port itself, but<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; describe how Nmap sees them. For example, an Nmap scan from the same<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; network as the target may show port 135/tcp as open, while a scan at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the same time with the same options from across the Internet might show<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; that port as filtered.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The six port states recognized by Nmap<br />
<br />
	&nbsp;&nbsp; An application is actively accepting TCP connections, UDP datagrams<br />
	&nbsp;&nbsp; or SCTP associations on this port. Finding these is often the<br />
	&nbsp;&nbsp; primary goal of port scanning. Security-minded people know that<br />
	&nbsp;&nbsp; each open port is an avenue for attack. Attackers and pen-testers<br />
	&nbsp;&nbsp; want to exploit the open ports, while administrators try to close<br />
	&nbsp;&nbsp; or protect them with firewalls without thwarting legitimate users.<br />
	&nbsp;&nbsp; Open ports are also interesting for non-security scans because they<br />
	&nbsp;&nbsp; show services available for use on the network.<br />
<br />
	&nbsp;&nbsp; A closed port is accessible (it receives and responds to Nmap probe<br />
	&nbsp;&nbsp; packets), but there is no application listening on it. They can be<br />
	&nbsp;&nbsp; helpful in showing that a host is up on an IP address (host<br />
	&nbsp;&nbsp; discovery, or ping scanning), and as part of OS detection. Because<br />
	&nbsp;&nbsp; closed ports are reachable, it may be worth scanning later in case<br />
	&nbsp;&nbsp; some open up. Administrators may want to consider blocking such<br />
	&nbsp;&nbsp; ports with a firewall. Then they would appear in the filtered<br />
	&nbsp;&nbsp; state, discussed next.<br />
<br />
	&nbsp;&nbsp; Nmap cannot determine whether the port is open because packet<br />
	&nbsp;&nbsp; filtering prevents its probes from reaching the port. The filtering<br />
	&nbsp;&nbsp; could be from a dedicated firewall device, router rules, or<br />
	&nbsp;&nbsp; host-based firewall software. These ports frustrate attackers<br />
	&nbsp;&nbsp; because they provide so little information. Sometimes they respond<br />
	&nbsp;&nbsp; with ICMP error messages such as type 3 code 13 (destination<br />
	&nbsp;&nbsp; unreachable: communication administratively prohibited), but<br />
	&nbsp;&nbsp; filters that simply drop probes without responding are far more<br />
	&nbsp;&nbsp; common. This forces Nmap to retry several times just in case the<br />
	&nbsp;&nbsp; probe was dropped due to network congestion rather than filtering.<br />
	&nbsp;&nbsp; This slows down the scan dramatically.<br />
<br />
	&nbsp;&nbsp; The unfiltered state means that a port is accessible, but Nmap is<br />
	&nbsp;&nbsp; unable to determine whether it is open or closed. Only the ACK<br />
	&nbsp;&nbsp; scan, which is used to map firewall rulesets, classifies ports into<br />
	&nbsp;&nbsp; this state. Scanning unfiltered ports with other scan types such as<br />
	&nbsp;&nbsp; Window scan, SYN scan, or FIN scan, may help resolve whether the<br />
	&nbsp;&nbsp; port is open.<br />
<br />
	&nbsp;&nbsp; Nmap places ports in this state when it is unable to determine<br />
	&nbsp;&nbsp; whether a port is open or filtered. This occurs for scan types in<br />
	&nbsp;&nbsp; which open ports give no response. The lack of response could also<br />
	&nbsp;&nbsp; mean that a packet filter dropped the probe or any response it<br />
	&nbsp;&nbsp; elicited. So Nmap does not know for sure whether the port is open<br />
	&nbsp;&nbsp; or being filtered. The UDP, IP protocol, FIN, NULL, and Xmas scans<br />
	&nbsp;&nbsp; classify ports this way.<br />
<br />
	&nbsp;&nbsp; This state is used when Nmap is unable to determine whether a port<br />
	&nbsp;&nbsp; is closed or filtered. It is only used for the IP ID idle scan.<br />
<br />
PORT SCANNING TECHNIQUES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; As a novice performing automotive repair, I can struggle for hours<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trying to fit my rudimentary tools (hammer, duct tape, wrench, etc.) to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the task at hand. When I fail miserably and tow my jalopy to a real<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mechanic, he invariably fishes around in a huge tool chest until<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pulling out the perfect gizmo which makes the job seem effortless. The<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; art of port scanning is similar. Experts understand the dozens of scan<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; techniques and choose the appropriate one (or combination) for a given<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; task. Inexperienced users and script kiddies,.&nbsp;&nbsp;on the other hand, try<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to solve every problem with the default SYN scan. Since Nmap is free,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the only barrier to port scanning mastery is knowledge. That certainly<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; beats the automotive world, where it may take great skill to determine<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; that you need a strut spring compressor, then you still have to pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; thousands of dollars for it.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Most of the scan types are only available to privileged users..	This<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is because they send and receive raw packets,.&nbsp;&nbsp;which requires root<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; access on Unix systems. Using an administrator account on Windows is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; recommended, though Nmap sometimes works for unprivileged users on that<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; platform when WinPcap has already been loaded into the OS. Requiring<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root privileges was a serious limitation when Nmap was released in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1997, as many users only had access to shared shell accounts. Now, the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; world is different. Computers are cheaper, far more people have<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; always-on direct Internet access, and desktop Unix systems (including<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Linux and Mac OS X) are prevalent. A Windows version of Nmap is now<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; available, allowing it to run on even more desktops. For all these<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reasons, users have less need to run Nmap from limited shared shell<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; accounts. This is fortunate, as the privileged options make Nmap far<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; more powerful and flexible.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While Nmap attempts to produce accurate results, keep in mind that all<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; of its insights are based on packets returned by the target machines<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (or firewalls in front of them). Such hosts may be untrustworthy and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; send responses intended to confuse or mislead Nmap. Much more common<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; are non-RFC-compliant hosts that do not respond as they should to Nmap<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; probes. FIN, NULL, and Xmas scans are particularly susceptible to this<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; problem. Such issues are specific to certain scan types and so are<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; discussed in the individual scan type entries.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This section documents the dozen or so port scan techniques supported<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; by Nmap. Only one method may be used at a time, except that UDP scan<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (-sU) and any one of the SCTP scan types (-sY, -sZ) may be combined<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; with any one of the TCP scan types. As a memory aid, port scan type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; options are of the form -sC, where C is a prominent character in the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scan name, usually the first. The one exception to this is the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; deprecated FTP bounce scan (-b). By default, Nmap performs a SYN Scan,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; though it substitutes a connect scan if the user does not have proper<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; privileges to send raw packets (requires root access on Unix). Of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scans listed in this section, unprivileged users can only execute<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connect and FTP bounce scans.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sS (TCP SYN scan) .<br />
	&nbsp;&nbsp; SYN scan is the default and most popular scan option for good<br />
	&nbsp;&nbsp; reasons. It can be performed quickly, scanning thousands of ports<br />
	&nbsp;&nbsp; per second on a fast network not hampered by restrictive firewalls.<br />
	&nbsp;&nbsp; It is also relatively unobtrusive and stealthy since it never<br />
	&nbsp;&nbsp; completes TCP connections. SYN scan works against any compliant TCP<br />
	&nbsp;&nbsp; stack rather than depending on idiosyncrasies of specific platforms<br />
	&nbsp;&nbsp; as Nmap's FIN/NULL/Xmas, Maimon and idle scans do. It also allows<br />
	&nbsp;&nbsp; clear, reliable differentiation between the open, closed, and<br />
	&nbsp;&nbsp; filtered states.<br />
<br />
	&nbsp;&nbsp; This technique is often referred to as half-open scanning, because<br />
	&nbsp;&nbsp; you don't open a full TCP connection. You send a SYN packet, as if<br />
	&nbsp;&nbsp; you are going to open a real connection and then wait for a<br />
	&nbsp;&nbsp; response. A SYN/ACK indicates the port is listening (open), while a<br />
	&nbsp;&nbsp; RST (reset) is indicative of a non-listener. If no response is<br />
	&nbsp;&nbsp; received after several retransmissions, the port is marked as<br />
	&nbsp;&nbsp; filtered. The port is also marked filtered if an ICMP unreachable<br />
	&nbsp;&nbsp; error (type 3, code 1, 2, 3, 9, 10, or 13) is received. The port is<br />
	&nbsp;&nbsp; also considered open if a SYN packet (without the ACK flag) is<br />
	&nbsp;&nbsp; received in response. This can be due to an extremely rare TCP<br />
	&nbsp;&nbsp; feature known as a simultaneous open or split handshake connection<br />
	&nbsp;&nbsp; (see http://nmap.org/misc/split-handshake.pdf).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sT (TCP connect scan) .<br />
	&nbsp;&nbsp; TCP connect scan is the default TCP scan type when SYN scan is not<br />
	&nbsp;&nbsp; an option. This is the case when a user does not have raw packet<br />
	&nbsp;&nbsp; privileges. Instead of writing raw packets as most other scan types<br />
	&nbsp;&nbsp; do, Nmap asks the underlying operating system to establish a<br />
	&nbsp;&nbsp; connection with the target machine and port by issuing the connect<br />
	&nbsp;&nbsp; system call. This is the same high-level system call that web<br />
	&nbsp;&nbsp; browsers, P2P clients, and most other network-enabled applications<br />
	&nbsp;&nbsp; use to establish a connection. It is part of a programming<br />
	&nbsp;&nbsp; interface known as the Berkeley Sockets API. Rather than read raw<br />
	&nbsp;&nbsp; packet responses off the wire, Nmap uses this API to obtain status<br />
	&nbsp;&nbsp; information on each connection attempt.<br />
<br />
	&nbsp;&nbsp; When SYN scan is available, it is usually a better choice. Nmap has<br />
	&nbsp;&nbsp; less control over the high level connect call than with raw<br />
	&nbsp;&nbsp; packets, making it less efficient. The system call completes<br />
	&nbsp;&nbsp; connections to open target ports rather than performing the<br />
	&nbsp;&nbsp; half-open reset that SYN scan does. Not only does this take longer<br />
	&nbsp;&nbsp; and require more packets to obtain the same information, but target<br />
	&nbsp;&nbsp; machines are more likely to log the connection. A decent IDS will<br />
	&nbsp;&nbsp; catch either, but most machines have no such alarm system. Many<br />
	&nbsp;&nbsp; services on your average Unix system will add a note to syslog, and<br />
	&nbsp;&nbsp; sometimes a cryptic error message, when Nmap connects and then<br />
	&nbsp;&nbsp; closes the connection without sending data. Truly pathetic services<br />
	&nbsp;&nbsp; crash when this happens, though that is uncommon. An administrator<br />
	&nbsp;&nbsp; who sees a bunch of connection attempts in her logs from a single<br />
	&nbsp;&nbsp; system should know that she has been connect scanned.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sU (UDP scans) .<br />
	&nbsp;&nbsp; While most popular services on the Internet run over the TCP<br />
	&nbsp;&nbsp; protocol, UDP[6] services are widely deployed. DNS, SNMP, and DHCP<br />
	&nbsp;&nbsp; (registered ports 53, 161/162, and 67/68) are three of the most<br />
	&nbsp;&nbsp; common. Because UDP scanning is generally slower and more difficult<br />
	&nbsp;&nbsp; than TCP, some security auditors ignore these ports. This is a<br />
	&nbsp;&nbsp; mistake, as exploitable UDP services are quite common and attackers<br />
	&nbsp;&nbsp; certainly don't ignore the whole protocol. Fortunately, Nmap can<br />
	&nbsp;&nbsp; help inventory UDP ports.<br />
<br />
	&nbsp;&nbsp; UDP scan is activated with the -sU option. It can be combined with<br />
	&nbsp;&nbsp; a TCP scan type such as SYN scan (-sS) to check both protocols<br />
	&nbsp;&nbsp; during the same run.<br />
<br />
	&nbsp;&nbsp; UDP scan works by sending a UDP packet to every targeted port. For<br />
	&nbsp;&nbsp; some common ports such as 53 and 161, a protocol-specific payload<br />
	&nbsp;&nbsp; is sent, but for most ports the packet is empty..&nbsp;&nbsp;The<br />
	&nbsp;&nbsp; --data-length option can be used to send a fixed-length random<br />
	&nbsp;&nbsp; payload to every port or (if you specify a value of 0) to disable<br />
	&nbsp;&nbsp; payloads. If an ICMP port unreachable error (type 3, code 3) is<br />
	&nbsp;&nbsp; returned, the port is closed. Other ICMP unreachable errors (type<br />
	&nbsp;&nbsp; 3, codes 1, 2, 9, 10, or 13) mark the port as filtered.<br />
	&nbsp;&nbsp; Occasionally, a service will respond with a UDP packet, proving<br />
	&nbsp;&nbsp; that it is open. If no response is received after retransmissions,<br />
	&nbsp;&nbsp; the port is classified as open|filtered. This means that the port<br />
	&nbsp;&nbsp; could be open, or perhaps packet filters are blocking the<br />
	&nbsp;&nbsp; communication. Version detection (-sV) can be used to help<br />
	&nbsp;&nbsp; differentiate the truly open ports from the filtered ones.<br />
<br />
	&nbsp;&nbsp; A big challenge with UDP scanning is doing it quickly. Open and<br />
	&nbsp;&nbsp; filtered ports rarely send any response, leaving Nmap to time out<br />
	&nbsp;&nbsp; and then conduct retransmissions just in case the probe or response<br />
	&nbsp;&nbsp; were lost. Closed ports are often an even bigger problem. They<br />
	&nbsp;&nbsp; usually send back an ICMP port unreachable error. But unlike the<br />
	&nbsp;&nbsp; RST packets sent by closed TCP ports in response to a SYN or<br />
	&nbsp;&nbsp; connect scan, many hosts rate limit.	 ICMP port unreachable<br />
	&nbsp;&nbsp; messages by default. Linux and Solaris are particularly strict<br />
	&nbsp;&nbsp; about this. For example, the Linux 2.4.20 kernel limits destination<br />
	&nbsp;&nbsp; unreachable messages to one per second (in net/ipv4/icmp.c).<br />
<br />
	&nbsp;&nbsp; Nmap detects rate limiting and slows down accordingly to avoid<br />
	&nbsp;&nbsp; flooding the network with useless packets that the target machine<br />
	&nbsp;&nbsp; will drop. Unfortunately, a Linux-style limit of one packet per<br />
	&nbsp;&nbsp; second makes a 65,536-port scan take more than 18 hours. Ideas for<br />
	&nbsp;&nbsp; speeding your UDP scans up include scanning more hosts in parallel,<br />
	&nbsp;&nbsp; doing a quick scan of just the popular ports first, scanning from<br />
	&nbsp;&nbsp; behind the firewall, and using --host-timeout to skip slow hosts.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sY (SCTP INIT scan) .<br />
	&nbsp;&nbsp; SCTP[7] is a relatively new alternative to the TCP and UDP<br />
	&nbsp;&nbsp; protocols, combining most characteristics of TCP and UDP, and also<br />
	&nbsp;&nbsp; adding new features like multi-homing and multi-streaming. It is<br />
	&nbsp;&nbsp; mostly being used for SS7/SIGTRAN related services but has the<br />
	&nbsp;&nbsp; potential to be used for other applications as well. SCTP INIT scan<br />
	&nbsp;&nbsp; is the SCTP equivalent of a TCP SYN scan. It can be performed<br />
	&nbsp;&nbsp; quickly, scanning thousands of ports per second on a fast network<br />
	&nbsp;&nbsp; not hampered by restrictive firewalls. Like SYN scan, INIT scan is<br />
	&nbsp;&nbsp; relatively unobtrusive and stealthy, since it never completes SCTP<br />
	&nbsp;&nbsp; associations. It also allows clear, reliable differentiation<br />
	&nbsp;&nbsp; between the open, closed, and filtered states.<br />
<br />
	&nbsp;&nbsp; This technique is often referred to as half-open scanning, because<br />
	&nbsp;&nbsp; you don't open a full SCTP association. You send an INIT chunk, as<br />
	&nbsp;&nbsp; if you are going to open a real association and then wait for a<br />
	&nbsp;&nbsp; response. An INIT-ACK chunk indicates the port is listening (open),<br />
	&nbsp;&nbsp; while an ABORT chunk is indicative of a non-listener. If no<br />
	&nbsp;&nbsp; response is received after several retransmissions, the port is<br />
	&nbsp;&nbsp; marked as filtered. The port is also marked filtered if an ICMP<br />
	&nbsp;&nbsp; unreachable error (type 3, code 1, 2, 3, 9, 10, or 13) is received.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sN; -sF; -sX (TCP NULL, FIN, and Xmas scans) .<br />
	&nbsp;&nbsp; These three scan types (even more are possible with the --scanflags<br />
	&nbsp;&nbsp; option described in the next section) exploit a subtle loophole in<br />
	&nbsp;&nbsp; the TCP RFC[8] to differentiate between open and closed ports. Page<br />
	&nbsp;&nbsp; 65 of RFC 793 says that "if the [destination] port state is CLOSED<br />
	&nbsp;&nbsp; .... an incoming segment not containing a RST causes a RST to be<br />
	&nbsp;&nbsp; sent in response."&nbsp;&nbsp;Then the next page discusses packets sent to<br />
	&nbsp;&nbsp; open ports without the SYN, RST, or ACK bits set, stating that:<br />
	&nbsp;&nbsp; "you are unlikely to get here, but if you do, drop the segment, and<br />
	&nbsp;&nbsp; return."<br />
<br />
	&nbsp;&nbsp; When scanning systems compliant with this RFC text, any packet not<br />
	&nbsp;&nbsp; containing SYN, RST, or ACK bits will result in a returned RST if<br />
	&nbsp;&nbsp; the port is closed and no response at all if the port is open. As<br />
	&nbsp;&nbsp; long as none of those three bits are included, any combination of<br />
	&nbsp;&nbsp; the other three (FIN, PSH, and URG) are OK. Nmap exploits this with<br />
	&nbsp;&nbsp; three scan types:<br />
<br />
	&nbsp;&nbsp; Null scan (-sN)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Does not set any bits (TCP flag header is 0)<br />
<br />
	&nbsp;&nbsp; FIN scan (-sF)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sets just the TCP FIN bit.<br />
<br />
	&nbsp;&nbsp; Xmas scan (-sX)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sets the FIN, PSH, and URG flags, lighting the packet up like a<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Christmas tree.<br />
<br />
	&nbsp;&nbsp; These three scan types are exactly the same in behavior except for<br />
	&nbsp;&nbsp; the TCP flags set in probe packets. If a RST packet is received,<br />
	&nbsp;&nbsp; the port is considered closed, while no response means it is<br />
	&nbsp;&nbsp; open|filtered. The port is marked filtered if an ICMP unreachable<br />
	&nbsp;&nbsp; error (type 3, code 1, 2, 3, 9, 10, or 13) is received.<br />
<br />
	&nbsp;&nbsp; The key advantage to these scan types is that they can sneak<br />
	&nbsp;&nbsp; through certain non-stateful firewalls and packet filtering<br />
	&nbsp;&nbsp; routers. Another advantage is that these scan types are a little<br />
	&nbsp;&nbsp; more stealthy than even a SYN scan. Don't count on this thoughmost<br />
	&nbsp;&nbsp; modern IDS products can be configured to detect them. The big<br />
	&nbsp;&nbsp; downside is that not all systems follow RFC 793 to the letter. A<br />
	&nbsp;&nbsp; number of systems send RST responses to the probes regardless of<br />
	&nbsp;&nbsp; whether the port is open or not. This causes all of the ports to be<br />
	&nbsp;&nbsp; labeled closed. Major operating systems that do this are Microsoft<br />
	&nbsp;&nbsp; Windows, many Cisco devices, BSDI, and IBM OS/400. This scan does<br />
	&nbsp;&nbsp; work against most Unix-based systems though. Another downside of<br />
	&nbsp;&nbsp; these scans is that they can't distinguish open ports from certain<br />
	&nbsp;&nbsp; filtered ones, leaving you with the response open|filtered.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sA (TCP ACK scan) .<br />
	&nbsp;&nbsp; This scan is different than the others discussed so far in that it<br />
	&nbsp;&nbsp; never determines open (or even open|filtered) ports. It is used to<br />
	&nbsp;&nbsp; map out firewall rulesets, determining whether they are stateful or<br />
	&nbsp;&nbsp; not and which ports are filtered.<br />
<br />
	&nbsp;&nbsp; The ACK scan probe packet has only the ACK flag set (unless you use<br />
	&nbsp;&nbsp; --scanflags). When scanning unfiltered systems, open and closed<br />
	&nbsp;&nbsp; ports will both return a RST packet. Nmap then labels them as<br />
	&nbsp;&nbsp; unfiltered, meaning that they are reachable by the ACK packet, but<br />
	&nbsp;&nbsp; whether they are open or closed is undetermined. Ports that don't<br />
	&nbsp;&nbsp; respond, or send certain ICMP error messages back (type 3, code 1,<br />
	&nbsp;&nbsp; 2, 3, 9, 10, or 13), are labeled filtered.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sW (TCP Window scan) .<br />
	&nbsp;&nbsp; Window scan is exactly the same as ACK scan except that it exploits<br />
	&nbsp;&nbsp; an implementation detail of certain systems to differentiate open<br />
	&nbsp;&nbsp; ports from closed ones, rather than always printing unfiltered when<br />
	&nbsp;&nbsp; a RST is returned. It does this by examining the TCP Window field<br />
	&nbsp;&nbsp; of the RST packets returned. On some systems, open ports use a<br />
	&nbsp;&nbsp; positive window size (even for RST packets) while closed ones have<br />
	&nbsp;&nbsp; a zero window. So instead of always listing a port as unfiltered<br />
	&nbsp;&nbsp; when it receives a RST back, Window scan lists the port as open or<br />
	&nbsp;&nbsp; closed if the TCP Window value in that reset is positive or zero,<br />
	&nbsp;&nbsp; respectively.<br />
<br />
	&nbsp;&nbsp; This scan relies on an implementation detail of a minority of<br />
	&nbsp;&nbsp; systems out on the Internet, so you can't always trust it. Systems<br />
	&nbsp;&nbsp; that don't support it will usually return all ports closed. Of<br />
	&nbsp;&nbsp; course, it is possible that the machine really has no open ports.<br />
	&nbsp;&nbsp; If most scanned ports are closed but a few common port numbers<br />
	&nbsp;&nbsp; (such as 22, 25, 53) are filtered, the system is most likely<br />
	&nbsp;&nbsp; susceptible. Occasionally, systems will even show the exact<br />
	&nbsp;&nbsp; opposite behavior. If your scan shows 1,000 open ports and three<br />
	&nbsp;&nbsp; closed or filtered ports, then those three may very well be the<br />
	&nbsp;&nbsp; truly open ones.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sM (TCP Maimon scan) .<br />
	&nbsp;&nbsp; The Maimon scan is named after its discoverer, Uriel Maimon..&nbsp;&nbsp;He<br />
	&nbsp;&nbsp; described the technique in Phrack Magazine issue #49 (November<br />
	&nbsp;&nbsp; 1996)..&nbsp;&nbsp;Nmap, which included this technique, was released two<br />
	&nbsp;&nbsp; issues later. This technique is exactly the same as NULL, FIN, and<br />
	&nbsp;&nbsp; Xmas scans, except that the probe is FIN/ACK. According to RFC<br />
	&nbsp;&nbsp; 793[8] (TCP), a RST packet should be generated in response to such<br />
	&nbsp;&nbsp; a probe whether the port is open or closed. However, Uriel noticed<br />
	&nbsp;&nbsp; that many BSD-derived systems simply drop the packet if the port is<br />
	&nbsp;&nbsp; open.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --scanflags (Custom TCP scan) .<br />
	&nbsp;&nbsp; Truly advanced Nmap users need not limit themselves to the canned<br />
	&nbsp;&nbsp; scan types offered. The --scanflags option allows you to design<br />
	&nbsp;&nbsp; your own scan by specifying arbitrary TCP flags..&nbsp;&nbsp;Let your<br />
	&nbsp;&nbsp; creative juices flow, while evading intrusion detection systems.<br />
	&nbsp;&nbsp; whose vendors simply paged through the Nmap man page adding<br />
	&nbsp;&nbsp; specific rules!<br />
<br />
	&nbsp;&nbsp; The --scanflags argument can be a numerical flag value such as 9<br />
	&nbsp;&nbsp; (PSH and FIN), but using symbolic names is easier. Just mash<br />
	&nbsp;&nbsp; together any combination of URG, ACK, PSH, RST, SYN, and FIN. For<br />
	&nbsp;&nbsp; example, --scanflags URGACKPSHRSTSYNFIN sets everything, though<br />
	&nbsp;&nbsp; it's not very useful for scanning. The order these are specified in<br />
	&nbsp;&nbsp; is irrelevant.<br />
<br />
	&nbsp;&nbsp; In addition to specifying the desired flags, you can specify a TCP<br />
	&nbsp;&nbsp; scan type (such as -sA or -sF). That base type tells Nmap how to<br />
	&nbsp;&nbsp; interpret responses. For example, a SYN scan considers no-response<br />
	&nbsp;&nbsp; to indicate a filtered port, while a FIN scan treats the same as<br />
	&nbsp;&nbsp; open|filtered. Nmap will behave the same way it does for the base<br />
	&nbsp;&nbsp; scan type, except that it will use the TCP flags you specify<br />
	&nbsp;&nbsp; instead. If you don't specify a base type, SYN scan is used.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sZ (SCTP COOKIE ECHO scan) .<br />
	&nbsp;&nbsp; SCTP COOKIE ECHO scan is a more advanced SCTP scan. It takes<br />
	&nbsp;&nbsp; advantage of the fact that SCTP implementations should silently<br />
	&nbsp;&nbsp; drop packets containing COOKIE ECHO chunks on open ports, but send<br />
	&nbsp;&nbsp; an ABORT if the port is closed. The advantage of this scan type is<br />
	&nbsp;&nbsp; that it is not as obvious a port scan than an INIT scan. Also,<br />
	&nbsp;&nbsp; there may be non-stateful firewall rulesets blocking INIT chunks,<br />
	&nbsp;&nbsp; but not COOKIE ECHO chunks. Don't be fooled into thinking that this<br />
	&nbsp;&nbsp; will make a port scan invisible; a good IDS will be able to detect<br />
	&nbsp;&nbsp; SCTP COOKIE ECHO scans too. The downside is that SCTP COOKIE ECHO<br />
	&nbsp;&nbsp; scans cannot differentiate between open and filtered ports, leaving<br />
	&nbsp;&nbsp; you with the state open|filtered in both cases.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sI zombie host[:probeport] (idle scan) .<br />
	&nbsp;&nbsp; This advanced scan method allows for a truly blind TCP port scan of<br />
	&nbsp;&nbsp; the target (meaning no packets are sent to the target from your<br />
	&nbsp;&nbsp; real IP address). Instead, a unique side-channel attack exploits<br />
	&nbsp;&nbsp; predictable IP fragmentation ID sequence generation on the zombie<br />
	&nbsp;&nbsp; host to glean information about the open ports on the target. IDS<br />
	&nbsp;&nbsp; systems will display the scan as coming from the zombie machine you<br />
	&nbsp;&nbsp; specify (which must be up and meet certain criteria).&nbsp;&nbsp;This<br />
	&nbsp;&nbsp; fascinating scan type is too complex to fully describe in this<br />
	&nbsp;&nbsp; reference guide, so I wrote and posted an informal paper with full<br />
	&nbsp;&nbsp; details at http://nmap.org/book/idlescan.html.<br />
<br />
	&nbsp;&nbsp; Besides being extraordinarily stealthy (due to its blind nature),<br />
	&nbsp;&nbsp; this scan type permits mapping out IP-based trust relationships<br />
	&nbsp;&nbsp; between machines. The port listing shows open ports from the<br />
	&nbsp;&nbsp; perspective of the zombie host.&nbsp;&nbsp;So you can try scanning a target<br />
	&nbsp;&nbsp; using various zombies that you think might be trusted.&nbsp;&nbsp;(via<br />
	&nbsp;&nbsp; router/packet filter rules).<br />
<br />
	&nbsp;&nbsp; You can add a colon followed by a port number to the zombie host if<br />
	&nbsp;&nbsp; you wish to probe a particular port on the zombie for IP ID<br />
	&nbsp;&nbsp; changes. Otherwise Nmap will use the port it uses by default for<br />
	&nbsp;&nbsp; TCP pings (80).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sO (IP protocol scan) .<br />
	&nbsp;&nbsp; IP protocol scan allows you to determine which IP protocols (TCP,<br />
	&nbsp;&nbsp; ICMP, IGMP, etc.) are supported by target machines. This isn't<br />
	&nbsp;&nbsp; technically a port scan, since it cycles through IP protocol<br />
	&nbsp;&nbsp; numbers rather than TCP or UDP port numbers. Yet it still uses the<br />
	&nbsp;&nbsp; -p option to select scanned protocol numbers, reports its results<br />
	&nbsp;&nbsp; within the normal port table format, and even uses the same<br />
	&nbsp;&nbsp; underlying scan engine as the true port scanning methods. So it is<br />
	&nbsp;&nbsp; close enough to a port scan that it belongs here.<br />
<br />
	&nbsp;&nbsp; Besides being useful in its own right, protocol scan demonstrates<br />
	&nbsp;&nbsp; the power of open-source software. While the fundamental idea is<br />
	&nbsp;&nbsp; pretty simple, I had not thought to add it nor received any<br />
	&nbsp;&nbsp; requests for such functionality. Then in the summer of 2000,<br />
	&nbsp;&nbsp; Gerhard Rieger.&nbsp;&nbsp;conceived the idea, wrote an excellent patch<br />
	&nbsp;&nbsp; implementing it, and sent it to the announce mailing list.&nbsp;&nbsp;(then<br />
	&nbsp;&nbsp; called nmap-hackers)..&nbsp;&nbsp;I incorporated that patch into the Nmap<br />
	&nbsp;&nbsp; tree and released a new version the next day. Few pieces of<br />
	&nbsp;&nbsp; commercial software have users enthusiastic enough to design and<br />
	&nbsp;&nbsp; contribute their own improvements!<br />
<br />
	&nbsp;&nbsp; Protocol scan works in a similar fashion to UDP scan. Instead of<br />
	&nbsp;&nbsp; iterating through the port number field of a UDP packet, it sends<br />
	&nbsp;&nbsp; IP packet headers and iterates through the eight-bit IP protocol<br />
	&nbsp;&nbsp; field. The headers are usually empty, containing no data and not<br />
	&nbsp;&nbsp; even the proper header for the claimed protocol. The exceptions are<br />
	&nbsp;&nbsp; TCP, UDP, ICMP, SCTP, and IGMP. A proper protocol header for those<br />
	&nbsp;&nbsp; is included since some systems won't send them otherwise and<br />
	&nbsp;&nbsp; because Nmap already has functions to create them. Instead of<br />
	&nbsp;&nbsp; watching for ICMP port unreachable messages, protocol scan is on<br />
	&nbsp;&nbsp; the lookout for ICMP protocol unreachable messages. If Nmap<br />
	&nbsp;&nbsp; receives any response in any protocol from the target host, Nmap<br />
	&nbsp;&nbsp; marks that protocol as open. An ICMP protocol unreachable error<br />
	&nbsp;&nbsp; (type 3, code 2) causes the protocol to be marked as closed Other<br />
	&nbsp;&nbsp; ICMP unreachable errors (type 3, code 1, 3, 9, 10, or 13) cause the<br />
	&nbsp;&nbsp; protocol to be marked filtered (though they prove that ICMP is open<br />
	&nbsp;&nbsp; at the same time). If no response is received after<br />
	&nbsp;&nbsp; retransmissions, the protocol is marked open|filtered<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -b FTP relay host (FTP bounce scan) .<br />
	&nbsp;&nbsp; An interesting feature of the FTP protocol (RFC 959[9]) is support<br />
	&nbsp;&nbsp; for so-called proxy FTP connections. This allows a user to connect<br />
	&nbsp;&nbsp; to one FTP server, then ask that files be sent to a third-party<br />
	&nbsp;&nbsp; server. Such a feature is ripe for abuse on many levels, so most<br />
	&nbsp;&nbsp; servers have ceased supporting it. One of the abuses this feature<br />
	&nbsp;&nbsp; allows is causing the FTP server to port scan other hosts. Simply<br />
	&nbsp;&nbsp; ask the FTP server to send a file to each interesting port of a<br />
	&nbsp;&nbsp; target host in turn. The error message will describe whether the<br />
	&nbsp;&nbsp; port is open or not. This is a good way to bypass firewalls because<br />
	&nbsp;&nbsp; organizational FTP servers are often placed where they have more<br />
	&nbsp;&nbsp; access to other internal hosts than any old Internet host would.<br />
	&nbsp;&nbsp; Nmap supports FTP bounce scan with the -b option. It takes an<br />
	&nbsp;&nbsp; argument of the form username:password@server:port.	Server is the<br />
	&nbsp;&nbsp; name or IP address of a vulnerable FTP server. As with a normal<br />
	&nbsp;&nbsp; URL, you may omit username:password, in which case anonymous login<br />
	&nbsp;&nbsp; credentials (user: anonymous password:-wwwuser@) are used. The port<br />
	&nbsp;&nbsp; number (and preceding colon) may be omitted as well, in which case<br />
	&nbsp;&nbsp; the default FTP port (21) on server is used.<br />
<br />
	&nbsp;&nbsp; This vulnerability was widespread in 1997 when Nmap was released,<br />
	&nbsp;&nbsp; but has largely been fixed. Vulnerable servers are still around, so<br />
	&nbsp;&nbsp; it is worth trying when all else fails. If bypassing a firewall is<br />
	&nbsp;&nbsp; your goal, scan the target network for port 21 (or even for any FTP<br />
	&nbsp;&nbsp; services if you scan all ports with version detection) and use the<br />
	&nbsp;&nbsp; ftp-bounce.	NSE script. Nmap will tell you whether the host is<br />
	&nbsp;&nbsp; vulnerable or not. If you are just trying to cover your tracks, you<br />
	&nbsp;&nbsp; don't need to (and, in fact, shouldn't) limit yourself to hosts on<br />
	&nbsp;&nbsp; the target network. Before you go scanning random Internet<br />
	&nbsp;&nbsp; addresses for vulnerable FTP servers, consider that sysadmins may<br />
	&nbsp;&nbsp; not appreciate you abusing their servers in this way.<br />
<br />
PORT SPECIFICATION AND SCAN ORDER<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; In addition to all of the scan methods discussed previously, Nmap<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offers options for specifying which ports are scanned and whether the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scan order is randomized or sequential. By default, Nmap scans the most<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; common 1,000 ports for each protocol.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -p port ranges (Only scan specified ports) .<br />
	&nbsp;&nbsp; This option specifies which ports you want to scan and overrides<br />
	&nbsp;&nbsp; the default. Individual port numbers are OK, as are ranges<br />
	&nbsp;&nbsp; separated by a hyphen (e.g.	1-1023). The beginning and/or end<br />
	&nbsp;&nbsp; values of a range may be omitted, causing Nmap to use 1 and 65535,<br />
	&nbsp;&nbsp; respectively. So you can specify -p- to scan ports from 1 through<br />
	&nbsp;&nbsp; 65535. Scanning port zero.&nbsp;&nbsp;is allowed if you specify it<br />
	&nbsp;&nbsp; explicitly. For IP protocol scanning (-sO), this option specifies<br />
	&nbsp;&nbsp; the protocol numbers you wish to scan for (0255).<br />
<br />
	&nbsp;&nbsp; When scanning a combination of protocols (e.g. TCP and UDP), you<br />
	&nbsp;&nbsp; can specify a particular protocol by preceding the port numbers by<br />
	&nbsp;&nbsp; T: for TCP, U: for UDP, S: for SCTP, or P: for IP Protocol. The<br />
	&nbsp;&nbsp; qualifier lasts until you specify another qualifier. For example,<br />
	&nbsp;&nbsp; the argument -p U:53,111,137,T:21-25,80,139,8080 would scan UDP<br />
	&nbsp;&nbsp; ports 53, 111,and 137, as well as the listed TCP ports. Note that<br />
	&nbsp;&nbsp; to scan both UDP and TCP, you have to specify -sU and at least one<br />
	&nbsp;&nbsp; TCP scan type (such as -sS, -sF, or -sT). If no protocol qualifier<br />
	&nbsp;&nbsp; is given, the port numbers are added to all protocol lists.	Ports<br />
	&nbsp;&nbsp; can also be specified by name according to what the port is<br />
	&nbsp;&nbsp; referred to in the nmap-services. You can even use the wildcards *<br />
	&nbsp;&nbsp; and ?&nbsp;&nbsp;with the names. For example, to scan FTP and all ports whose<br />
	&nbsp;&nbsp; names begin with "http", use -p ftp,http*. Be careful about shell<br />
	&nbsp;&nbsp; expansions and quote the argument to -p if unsure.<br />
<br />
	&nbsp;&nbsp; Ranges of ports can be surrounded by square brackets to indicate<br />
	&nbsp;&nbsp; ports inside that range that appear in nmap-services. For example,<br />
	&nbsp;&nbsp; the following will scan all ports in nmap-services equal to or<br />
	&nbsp;&nbsp; below 1024: -p [-1024]. Be careful with shell expansions and quote<br />
	&nbsp;&nbsp; the argument to -p if unsure.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -F (Fast (limited port) scan) .<br />
	&nbsp;&nbsp; Specifies that you wish to scan fewer ports than the default.<br />
	&nbsp;&nbsp; Normally Nmap scans the most common 1,000 ports for each scanned<br />
	&nbsp;&nbsp; protocol. With -F, this is reduced to 100.<br />
<br />
	&nbsp;&nbsp; Nmap needs an nmap-services file with frequency information in<br />
	&nbsp;&nbsp; order to know which ports are the most common. If port frequency<br />
	&nbsp;&nbsp; information isn't available, perhaps because of the use of a custom<br />
	&nbsp;&nbsp; nmap-services file, Nmap scans all named ports plus ports 1-1024.<br />
	&nbsp;&nbsp; In that case, -F means to scan only ports that are named in the<br />
	&nbsp;&nbsp; services file.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -r (Don't randomize ports) .<br />
	&nbsp;&nbsp; By default, Nmap randomizes the scanned port order (except that<br />
	&nbsp;&nbsp; certain commonly accessible ports are moved near the beginning for<br />
	&nbsp;&nbsp; efficiency reasons). This randomization is normally desirable, but<br />
	&nbsp;&nbsp; you can specify -r for sequential (sorted from lowest to highest)<br />
	&nbsp;&nbsp; port scanning instead.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --port-ratio ratio&lt;decimal number between 0 and 1&gt;<br />
	&nbsp;&nbsp; Scans all ports in nmap-services file with a ratio greater than the<br />
	&nbsp;&nbsp; one given.&nbsp;&nbsp;ratio must be between 0.0 and 1.1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --top-ports n<br />
	&nbsp;&nbsp; Scans the n highest-ratio ports found in nmap-services file.	 n<br />
	&nbsp;&nbsp; must be 1 or greater.<br />
<br />
SERVICE AND VERSION DETECTION<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point Nmap at a remote machine and it might tell you that ports 25/tcp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 80/tcp, and 53/udp are open. Using its nmap-services.&nbsp;&nbsp;database of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; about 2,200 well-known services,.&nbsp;&nbsp;Nmap would report that those ports<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; probably correspond to a mail server (SMTP), web server (HTTP), and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; name server (DNS) respectively. This lookup is usually accuratethe<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vast majority of daemons listening on TCP port 25 are, in fact, mail<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; servers. However, you should not bet your security on this! People can<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and do run services on strange ports..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Even if Nmap is right, and the hypothetical server above is running<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SMTP, HTTP, and DNS servers, that is not a lot of information. When<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; doing vulnerability assessments (or even simple network inventories) of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; your companies or clients, you really want to know which mail and DNS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; servers and versions are running. Having an accurate version number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; helps dramatically in determining which exploits a server is vulnerable<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to. Version detection helps you obtain this information.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; After TCP and/or UDP ports are discovered using one of the other scan<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; methods, version detection interrogates those ports to determine more<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; about what is actually running. The nmap-service-probes.	 database<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contains probes for querying various services and match expressions to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; recognize and parse responses. Nmap tries to determine the service<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protocol (e.g. FTP, SSH, Telnet, HTTP), the application name (e.g. ISC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BIND, Apache httpd, Solaris telnetd), the version number, hostname,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; device type (e.g. printer, router), the OS family (e.g. Windows,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Linux). When possible, Nmap also gets the Common Platform Enumeration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (CPE).&nbsp;&nbsp;representation of this information. Sometimes miscellaneous<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; details like whether an X server is open to connections, the SSH<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protocol version, or the KaZaA user name, are available. Of course,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; most services don't provide all of this information. If Nmap was<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; compiled with OpenSSL support, it will connect to SSL servers to deduce<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the service listening behind that encryption layer..&nbsp;&nbsp;Some UDP ports<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; are left in the open|filtered state after a UDP port scan is unable to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; determine whether the port is open or filtered. Version detection will<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try to elicit a response from these ports (just as it does with open<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ports), and change the state to open if it succeeds.&nbsp;&nbsp;open|filtered TCP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ports are treated the same way. Note that the Nmap -A option enables<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version detection among other things.&nbsp;&nbsp;A paper documenting the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; workings, usage, and customization of version detection is available at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://nmap.org/book/vscan.html.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; When RPC services are discovered, the Nmap RPC grinder.	is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; automatically used to determine the RPC program and version numbers. It<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; takes all the TCP/UDP ports detected as RPC and floods them with SunRPC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; program NULL commands in an attempt to determine whether they are RPC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ports, and if so, what program and version number they serve up. Thus<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; you can effectively obtain the same info as rpcinfo -p even if the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target's portmapper is behind a firewall (or protected by TCP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wrappers). Decoys do not currently work with RPC scan..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; When Nmap receives responses from a service but cannot match them to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; its database, it prints out a special fingerprint and a URL for you to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; submit if to if you know for sure what is running on the port. Please<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; take a couple minutes to make the submission so that your find can<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; benefit everyone. Thanks to these submissions, Nmap has about 6,500<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pattern matches for more than 650 protocols such as SMTP, FTP, HTTP,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; etc..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Version detection is enabled and controlled with the following options:<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sV (Version detection) .<br />
	&nbsp;&nbsp; Enables version detection, as discussed above. Alternatively, you<br />
	&nbsp;&nbsp; can use -A, which enables version detection among other things.<br />
<br />
	&nbsp;&nbsp; -sR.	 is an alias for -sV. Prior to March 2011, it was used to<br />
	&nbsp;&nbsp; active the RPC grinder separately from version detection, but now<br />
	&nbsp;&nbsp; these options are always combined.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --allports (Don't exclude any ports from version detection) .<br />
	&nbsp;&nbsp; By default, Nmap version detection skips TCP port 9100 because some<br />
	&nbsp;&nbsp; printers simply print anything sent to that port, leading to dozens<br />
	&nbsp;&nbsp; of pages of HTTP GET requests, binary SSL session requests, etc.<br />
	&nbsp;&nbsp; This behavior can be changed by modifying or removing the Exclude<br />
	&nbsp;&nbsp; directive in nmap-service-probes, or you can specify --allports to<br />
	&nbsp;&nbsp; scan all ports regardless of any Exclude directive.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --version-intensity intensity (Set version scan intensity) .<br />
	&nbsp;&nbsp; When performing a version scan (-sV), Nmap sends a series of<br />
	&nbsp;&nbsp; probes, each of which is assigned a rarity value between one and<br />
	&nbsp;&nbsp; nine. The lower-numbered probes are effective against a wide<br />
	&nbsp;&nbsp; variety of common services, while the higher-numbered ones are<br />
	&nbsp;&nbsp; rarely useful. The intensity level specifies which probes should be<br />
	&nbsp;&nbsp; applied. The higher the number, the more likely it is the service<br />
	&nbsp;&nbsp; will be correctly identified. However, high intensity scans take<br />
	&nbsp;&nbsp; longer. The intensity must be between 0 and 9..&nbsp;&nbsp;The default is 7..<br />
	&nbsp;&nbsp; When a probe is registered to the target port via the<br />
	&nbsp;&nbsp; nmap-service-probesports directive, that probe is tried regardless<br />
	&nbsp;&nbsp; of intensity level. This ensures that the DNS probes will always be<br />
	&nbsp;&nbsp; attempted against any open port 53, the SSL probe will be done<br />
	&nbsp;&nbsp; against 443, etc.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --version-light (Enable light mode) .<br />
	&nbsp;&nbsp; This is a convenience alias for --version-intensity 2. This light<br />
	&nbsp;&nbsp; mode makes version scanning much faster, but it is slightly less<br />
	&nbsp;&nbsp; likely to identify services.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --version-all (Try every single probe) .<br />
	&nbsp;&nbsp; An alias for --version-intensity 9, ensuring that every single<br />
	&nbsp;&nbsp; probe is attempted against each port.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --version-trace (Trace version scan activity) .<br />
	&nbsp;&nbsp; This causes Nmap to print out extensive debugging info about what<br />
	&nbsp;&nbsp; version scanning is doing. It is a subset of what you get with<br />
	&nbsp;&nbsp; --packet-trace.<br />
<br />
OS DETECTION<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One of Nmap's best-known features is remote OS detection using TCP/IP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stack fingerprinting. Nmap sends a series of TCP and UDP packets to the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; remote host and examines practically every bit in the responses. After<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; performing dozens of tests such as TCP ISN sampling, TCP options<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; support and ordering, IP ID sampling, and the initial window size<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; check, Nmap compares the results to its nmap-os-db.&nbsp;&nbsp;database of more<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; than 2,600 known OS fingerprints and prints out the OS details if there<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is a match. Each fingerprint includes a freeform textual description of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the OS, and a classification which provides the vendor name (e.g. Sun),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; underlying OS (e.g. Solaris), OS generation (e.g. 10), and device type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (general purpose, router, switch, game console, etc). Most fingerprints<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; also have a Common Platform Enumeration (CPE).&nbsp;&nbsp;representation, like<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cpe:/o:linux:linux_kernel:2.6.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Nmap is unable to guess the OS of a machine, and conditions are good<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (e.g. at least one open port and one closed port were found), Nmap will<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; provide a URL you can use to submit the fingerprint if you know (for<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sure) the OS running on the machine. By doing this you contribute to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the pool of operating systems known to Nmap and thus it will be more<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; accurate for everyone.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OS detection enables some other tests which make use of information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; that is gathered during the process anyway. One of these is TCP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sequence Predictability Classification. This measures approximately how<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hard it is to establish a forged TCP connection against the remote<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; host. It is useful for exploiting source-IP based trust relationships<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (rlogin, firewall filters, etc) or for hiding the source of an attack.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This sort of spoofing is rarely performed any more, but many machines<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; are still vulnerable to it. The actual difficulty number is based on<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; statistical sampling and may fluctuate. It is generally better to use<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the English classification such as "worthy challenge" or "trivial<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; joke". This is only reported in normal output in verbose (-v) mode.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; When verbose mode is enabled along with -O, IP ID sequence generation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is also reported. Most machines are in the "incremental" class, which<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; means that they increment the ID field in the IP header for each packet<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; they send. This makes them vulnerable to several advanced information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gathering and spoofing attacks.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Another bit of extra information enabled by OS detection is a guess at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a target's uptime. This uses the TCP timestamp option (RFC 1323[10]) to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; guess when a machine was last rebooted. The guess can be inaccurate due<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to the timestamp counter not being initialized to zero or the counter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; overflowing and wrapping around, so it is printed only in verbose mode.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A paper documenting the workings, usage, and customization of OS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; detection is available at http://nmap.org/book/osdetect.html.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OS detection is enabled and controlled with the following options:<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -O (Enable OS detection) .<br />
	&nbsp;&nbsp; Enables OS detection, as discussed above. Alternatively, you can<br />
	&nbsp;&nbsp; use -A to enable OS detection along with other things.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --osscan-limit (Limit OS detection to promising targets) .<br />
	&nbsp;&nbsp; OS detection is far more effective if at least one open and one<br />
	&nbsp;&nbsp; closed TCP port are found. Set this option and Nmap will not even<br />
	&nbsp;&nbsp; try OS detection against hosts that do not meet this criteria. This<br />
	&nbsp;&nbsp; can save substantial time, particularly on -Pn scans against many<br />
	&nbsp;&nbsp; hosts. It only matters when OS detection is requested with -O or<br />
	&nbsp;&nbsp; -A.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --osscan-guess; --fuzzy (Guess OS detection results) .<br />
	&nbsp;&nbsp; When Nmap is unable to detect a perfect OS match, it sometimes<br />
	&nbsp;&nbsp; offers up near-matches as possibilities. The match has to be very<br />
	&nbsp;&nbsp; close for Nmap to do this by default. Either of these (equivalent)<br />
	&nbsp;&nbsp; options make Nmap guess more aggressively. Nmap will still tell you<br />
	&nbsp;&nbsp; when an imperfect match is printed and display its confidence level<br />
	&nbsp;&nbsp; (percentage) for each guess.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --max-os-tries (Set the maximum number of OS detection tries against a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target) .<br />
	&nbsp;&nbsp; When Nmap performs OS detection against a target and fails to find<br />
	&nbsp;&nbsp; a perfect match, it usually repeats the attempt. By default, Nmap<br />
	&nbsp;&nbsp; tries five times if conditions are favorable for OS fingerprint<br />
	&nbsp;&nbsp; submission, and twice when conditions aren't so good. Specifying a<br />
	&nbsp;&nbsp; lower --max-os-tries value (such as 1) speeds Nmap up, though you<br />
	&nbsp;&nbsp; miss out on retries which could potentially identify the OS.<br />
	&nbsp;&nbsp; Alternatively, a high value may be set to allow even more retries<br />
	&nbsp;&nbsp; when conditions are favorable. This is rarely done, except to<br />
	&nbsp;&nbsp; generate better fingerprints for submission and integration into<br />
	&nbsp;&nbsp; the Nmap OS database.<br />
<br />
NMAP SCRIPTING ENGINE (NSE)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Nmap Scripting Engine (NSE) is one of Nmap's most powerful and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; flexible features. It allows users to write (and share) simple scripts<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (using the Lua programming language[11],<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Tasks we had in mind when creating the system include network<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; discovery, more sophisticated version detection, vulnerability<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; detection. NSE can even be used for vulnerability exploitation.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; To reflect those different uses and to simplify the choice of which<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scripts to run, each script contains a field associating it with one or<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; more categories. Currently defined categories are auth, broadcast,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default.	 discovery, dos, exploit, external, fuzzer, intrusive,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; malware, safe, version, and vuln. These are all described at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://nmap.org/book/nse-usage.html#nse-categories.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Scripts are not run in a sandbox and thus could accidentally or<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; maliciously damage your system or invade your privacy. Never run<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scripts from third parties unless you trust the authors or have<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carefully audited the scripts yourself.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Nmap Scripting Engine is described in detail at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://nmap.org/book/nse.html and is controlled by the following<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; options:<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -sC .<br />
	&nbsp;&nbsp; Performs a script scan using the default set of scripts. It is<br />
	&nbsp;&nbsp; equivalent to --script=default. Some of the scripts in this<br />
	&nbsp;&nbsp; category are considered intrusive and should not be run against a<br />
	&nbsp;&nbsp; target network without permission.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --script filename|category|directory|expression[,...] .<br />
	&nbsp;&nbsp; Runs a script scan using the comma-separated list of filenames,<br />
	&nbsp;&nbsp; script categories, and directories. Each element in the list may<br />
	&nbsp;&nbsp; also be a Boolean expression describing a more complex set of<br />
	&nbsp;&nbsp; scripts. Each element is interpreted first as an expression, then<br />
	&nbsp;&nbsp; as a category, and finally as a file or directory name.<br />
<br />
	&nbsp;&nbsp; There are two special features for advanced users only. One is to<br />
	&nbsp;&nbsp; prefix script names and expressions with + to force them to run<br />
	&nbsp;&nbsp; even if they normally wouldn't (e.g. the relevant service wasn't<br />
	&nbsp;&nbsp; detected on the target port). The other is that the argument all<br />
	&nbsp;&nbsp; may be used to specify every script in Nmap's database. Be cautious<br />
	&nbsp;&nbsp; with this because NSE contains dangerous scripts such as exploits,<br />
	&nbsp;&nbsp; brute force authentication crackers, and denial of service attacks.<br />
<br />
	&nbsp;&nbsp; File and directory names may be relative or absolute. Absolute<br />
	&nbsp;&nbsp; names are used directly. Relative paths are looked for in the<br />
	&nbsp;&nbsp; scripts of each of the following places until found: --datadir<br />
	&nbsp;&nbsp; $NMAPDIR.<br />
	&nbsp;&nbsp; ~/.nmap (not searched on Windows).<br />
	&nbsp;&nbsp; HOME\AppData\Roaming\nmap (only on Windows).<br />
	&nbsp;&nbsp; the directory containing the nmap executable<br />
	&nbsp;&nbsp; the directory containing the nmap executable, followed by<br />
	&nbsp;&nbsp; ../share/nmap<br />
	&nbsp;&nbsp; NMAPDATADIR.<br />
	&nbsp;&nbsp; the current directory.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; When a directory name is given, Nmap loads every file in the directory<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; whose name ends with .nse. All other files are ignored and directories<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; are not searched recursively. When a filename is given, it does not<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; have to have the .nse extension; it will be added automatically if<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; necessary.&nbsp;&nbsp;Nmap scripts are stored in a scripts subdirectory of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap data directory by default (see<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://nmap.org/book/data-files.html).&nbsp;&nbsp;For efficiency, scripts are<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; indexed in a database stored in scripts/script.db,.&nbsp;&nbsp;which lists the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; category or categories in which each script belongs.&nbsp;&nbsp;When referring to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scripts from script.db by name, you can use a shell-style * wildcard.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nmap --script &quot;http-*&quot;<br />
	&nbsp;&nbsp; Loads all scripts whose name starts with http-, such as http-auth<br />
	&nbsp;&nbsp; and http-open-proxy. The argument to --script had to be in quotes<br />
	&nbsp;&nbsp; to protect the wildcard from the shell.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; More complicated script selection can be done using the and, or, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; not operators to build Boolean expressions. The operators have the same<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; precedence[12] as in Lua: not is the highest, followed by and and then<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or. You can alter precedence by using parentheses. Because expressions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contain space characters it is necessary to quote them.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nmap --script &quot;not intrusive&quot;<br />
	&nbsp;&nbsp; Loads every script except for those in the intrusive category.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nmap --script &quot;default or safe&quot;<br />
	&nbsp;&nbsp; This is functionally equivalent to nmap --script &quot;default,safe&quot;. It<br />
	&nbsp;&nbsp; loads all scripts that are in the default category or the safe<br />
	&nbsp;&nbsp; category or both.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nmap --script &quot;default and safe&quot;<br />
	&nbsp;&nbsp; Loads those scripts that are in both the default and safe<br />
	&nbsp;&nbsp; categories.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nmap --script &quot;(default or safe or intrusive) and not http-*&quot;<br />
	&nbsp;&nbsp; Loads scripts in the default, safe, or intrusive categories, except<br />
	&nbsp;&nbsp; for those whose names start with http-.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --script-args n1=v1,n2={n3=v3},n4={v4,v5} .<br />
	&nbsp;&nbsp; Lets you provide arguments to NSE scripts. Arguments are a<br />
	&nbsp;&nbsp; comma-separated list of name=value pairs. Names and values may be<br />
	&nbsp;&nbsp; strings not containing whitespace or the characters {, }, =,<br />
	&nbsp;&nbsp; or ,. To include one of these characters in a string, enclose the<br />
	&nbsp;&nbsp; string in single or double quotes. Within a quoted string, \<br />
	&nbsp;&nbsp; escapes a quote. A backslash is only used to escape quotation marks<br />
	&nbsp;&nbsp; in this special case; in all other cases a backslash is interpreted<br />
	&nbsp;&nbsp; literally. Values may also be tables enclosed in {}, just as in<br />
	&nbsp;&nbsp; Lua. A table may contain simple string values or more name-value<br />
	&nbsp;&nbsp; pairs, including nested tables. Many scripts qualify their<br />
	&nbsp;&nbsp; arguments with the script name, as in xmpp-info.server_name. You<br />
	&nbsp;&nbsp; may use that full qualified version to affect just the specified<br />
	&nbsp;&nbsp; script, or you may pass the unqualified version (server_name in<br />
	&nbsp;&nbsp; this case) to affect all scripts using that argument name. A script<br />
	&nbsp;&nbsp; will first check for its fully qualified argument name (the name<br />
	&nbsp;&nbsp; specified in its documentation) before it accepts an unqualified<br />
	&nbsp;&nbsp; argument name. A complex example of script arguments is<br />
	&nbsp;&nbsp; --script-args<br />
	&nbsp;&nbsp; 'user=foo,pass=&quot;,{}=bar&quot;,whois={whodb=nofollow+ripe},xmpp-info.server_name=localhost'.<br />
	&nbsp;&nbsp; The online NSE Documentation Portal at http://nmap.org/nsedoc/<br />
	&nbsp;&nbsp; lists the arguments that each script accepts.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --script-args-file filename .<br />
	&nbsp;&nbsp; Lets you load arguments to NSE scripts from a file. Any arguments<br />
	&nbsp;&nbsp; on the command line supersede ones in the file. The file can be an<br />
	&nbsp;&nbsp; absolute path, or a path relative to Nmap's usual search path<br />
	&nbsp;&nbsp; (NMAPDIR, etc.) Arguments can be comma-separated or<br />
	&nbsp;&nbsp; newline-separated, but otherwise follow the same rules as for<br />
	&nbsp;&nbsp; --script-args, without requiring special quoting and escaping,<br />
	&nbsp;&nbsp; since they are not parsed by the shell.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --script-help filename|category|directory|expression|all[,...] .<br />
	&nbsp;&nbsp; Shows help about scripts. For each script matching the given<br />
	&nbsp;&nbsp; specification, Nmap prints the script name, its categories, and its<br />
	&nbsp;&nbsp; description. The specifications are the same as those accepted by<br />
	&nbsp;&nbsp; --script; so for example if you want help about the ftp-anon<br />
	&nbsp;&nbsp; script, you would run nmap --script-help ftp-anon. In addition to<br />
	&nbsp;&nbsp; getting help for individual scripts, you can use this as a preview<br />
	&nbsp;&nbsp; of what scripts will be run for a specification, for example with<br />
	&nbsp;&nbsp; nmap --script-help default.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --script-trace .<br />
	&nbsp;&nbsp; This option does what --packet-trace does, just one ISO layer<br />
	&nbsp;&nbsp; higher. If this option is specified all incoming and outgoing<br />
	&nbsp;&nbsp; communication performed by a script is printed. The displayed<br />
	&nbsp;&nbsp; information includes the communication protocol, the source, the<br />
	&nbsp;&nbsp; target and the transmitted data. If more than 5% of all transmitted<br />
	&nbsp;&nbsp; data is not printable, then the trace output is in a hex dump<br />
	&nbsp;&nbsp; format. Specifying --packet-trace enables script tracing too.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --script-updatedb .<br />
	&nbsp;&nbsp; This option updates the script database found in scripts/script.db<br />
	&nbsp;&nbsp; which is used by Nmap to determine the available default scripts<br />
	&nbsp;&nbsp; and categories. It is only necessary to update the database if you<br />
	&nbsp;&nbsp; have added or removed NSE scripts from the default scripts<br />
	&nbsp;&nbsp; directory or if you have changed the categories of any script. This<br />
	&nbsp;&nbsp; option is generally used by itself: nmap --script-updatedb.<br />
<br />
TIMING AND PERFORMANCE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One of my highest Nmap development priorities has always been<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; performance. A default scan (nmap hostname) of a host on my local<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; network takes a fifth of a second. That is barely enough time to blink,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; but adds up when you are scanning hundreds or thousands of hosts.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Moreover, certain scan options such as UDP scanning and version<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; detection can increase scan times substantially. So can certain<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; firewall configurations, particularly response rate limiting. While<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap utilizes parallelism and many advanced algorithms to accelerate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; these scans, the user has ultimate control over how Nmap runs. Expert<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; users carefully craft Nmap commands to obtain only the information they<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; care about while meeting their time constraints.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Techniques for improving scan times include omitting non-critical<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tests, and upgrading to the latest version of Nmap (performance<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enhancements are made frequently). Optimizing timing parameters can<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; also make a substantial difference. Those options are listed below.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Some options accept a time parameter. This is specified in seconds by<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default, though you can append ms, s, m, or h to the value to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specify milliseconds, seconds, minutes, or hours. So the --host-timeout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arguments 900000ms, 900, 900s, and 15m all do the same thing.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --min-hostgroup numhosts; --max-hostgroup numhosts (Adjust parallel<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scan group sizes) .<br />
	&nbsp;&nbsp; Nmap has the ability to port scan or version scan multiple hosts in<br />
	&nbsp;&nbsp; parallel. Nmap does this by dividing the target IP space into<br />
	&nbsp;&nbsp; groups and then scanning one group at a time. In general, larger<br />
	&nbsp;&nbsp; groups are more efficient. The downside is that host results can't<br />
	&nbsp;&nbsp; be provided until the whole group is finished. So if Nmap started<br />
	&nbsp;&nbsp; out with a group size of 50, the user would not receive any reports<br />
	&nbsp;&nbsp; (except for the updates offered in verbose mode) until the first 50<br />
	&nbsp;&nbsp; hosts are completed.<br />
<br />
	&nbsp;&nbsp; By default, Nmap takes a compromise approach to this conflict. It<br />
	&nbsp;&nbsp; starts out with a group size as low as five so the first results<br />
	&nbsp;&nbsp; come quickly and then increases the groupsize to as high as 1024.<br />
	&nbsp;&nbsp; The exact default numbers depend on the options given. For<br />
	&nbsp;&nbsp; efficiency reasons, Nmap uses larger group sizes for UDP or<br />
	&nbsp;&nbsp; few-port TCP scans.<br />
<br />
	&nbsp;&nbsp; When a maximum group size is specified with --max-hostgroup, Nmap<br />
	&nbsp;&nbsp; will never exceed that size. Specify a minimum size with<br />
	&nbsp;&nbsp; --min-hostgroup and Nmap will try to keep group sizes above that<br />
	&nbsp;&nbsp; level. Nmap may have to use smaller groups than you specify if<br />
	&nbsp;&nbsp; there are not enough target hosts left on a given interface to<br />
	&nbsp;&nbsp; fulfill the specified minimum. Both may be set to keep the group<br />
	&nbsp;&nbsp; size within a specific range, though this is rarely desired.<br />
<br />
	&nbsp;&nbsp; These options do not have an effect during the host discovery phase<br />
	&nbsp;&nbsp; of a scan. This includes plain ping scans (-sn). Host discovery<br />
	&nbsp;&nbsp; always works in large groups of hosts to improve speed and<br />
	&nbsp;&nbsp; accuracy.<br />
<br />
	&nbsp;&nbsp; The primary use of these options is to specify a large minimum<br />
	&nbsp;&nbsp; group size so that the full scan runs more quickly. A common choice<br />
	&nbsp;&nbsp; is 256 to scan a network in Class C sized chunks. For a scan with<br />
	&nbsp;&nbsp; many ports, exceeding that number is unlikely to help much. For<br />
	&nbsp;&nbsp; scans of just a few port numbers, host group sizes of 2048 or more<br />
	&nbsp;&nbsp; may be helpful.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --min-parallelism numprobes; --max-parallelism numprobes (Adjust probe<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parallelization) .<br />
	&nbsp;&nbsp; These options control the total number of probes that may be<br />
	&nbsp;&nbsp; outstanding for a host group. They are used for port scanning and<br />
	&nbsp;&nbsp; host discovery. By default, Nmap calculates an ever-changing ideal<br />
	&nbsp;&nbsp; parallelism based on network performance. If packets are being<br />
	&nbsp;&nbsp; dropped, Nmap slows down and allows fewer outstanding probes. The<br />
	&nbsp;&nbsp; ideal probe number slowly rises as the network proves itself<br />
	&nbsp;&nbsp; worthy. These options place minimum or maximum bounds on that<br />
	&nbsp;&nbsp; variable. By default, the ideal parallelism can drop to one if the<br />
	&nbsp;&nbsp; network proves unreliable and rise to several hundred in perfect<br />
	&nbsp;&nbsp; conditions.<br />
<br />
	&nbsp;&nbsp; The most common usage is to set --min-parallelism to a number<br />
	&nbsp;&nbsp; higher than one to speed up scans of poorly performing hosts or<br />
	&nbsp;&nbsp; networks. This is a risky option to play with, as setting it too<br />
	&nbsp;&nbsp; high may affect accuracy. Setting this also reduces Nmap's ability<br />
	&nbsp;&nbsp; to control parallelism dynamically based on network conditions. A<br />
	&nbsp;&nbsp; value of 10 might be reasonable, though I only adjust this value as<br />
	&nbsp;&nbsp; a last resort.<br />
<br />
	&nbsp;&nbsp; The --max-parallelism option is sometimes set to one to prevent<br />
	&nbsp;&nbsp; Nmap from sending more than one probe at a time to hosts. The<br />
	&nbsp;&nbsp; --scan-delay option, discussed later, is another way to do this.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --min-rtt-timeout time, --max-rtt-timeout time, --initial-rtt-timeout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; time (Adjust probe timeouts) .<br />
	&nbsp;&nbsp; Nmap maintains a running timeout value for determining how long it<br />
	&nbsp;&nbsp; will wait for a probe response before giving up or retransmitting<br />
	&nbsp;&nbsp; the probe. This is calculated based on the response times of<br />
	&nbsp;&nbsp; previous probes.<br />
<br />
	&nbsp;&nbsp; If the network latency shows itself to be significant and variable,<br />
	&nbsp;&nbsp; this timeout can grow to several seconds. It also starts at a<br />
	&nbsp;&nbsp; conservative (high) level and may stay that way for a while when<br />
	&nbsp;&nbsp; Nmap scans unresponsive hosts.<br />
<br />
	&nbsp;&nbsp; Specifying a lower --max-rtt-timeout and --initial-rtt-timeout than<br />
	&nbsp;&nbsp; the defaults can cut scan times significantly. This is particularly<br />
	&nbsp;&nbsp; true for pingless (-Pn) scans, and those against heavily filtered<br />
	&nbsp;&nbsp; networks. Don't get too aggressive though. The scan can end up<br />
	&nbsp;&nbsp; taking longer if you specify such a low value that many probes are<br />
	&nbsp;&nbsp; timing out and retransmitting while the response is in transit.<br />
<br />
	&nbsp;&nbsp; If all the hosts are on a local network, 100 milliseconds<br />
	&nbsp;&nbsp; (--max-rtt-timeout 100ms) is a reasonable aggressive value. If<br />
	&nbsp;&nbsp; routing is involved, ping a host on the network first with the ICMP<br />
	&nbsp;&nbsp; ping utility, or with a custom packet crafter such as Nping.	 that<br />
	&nbsp;&nbsp; is more likely to get through a firewall. Look at the maximum round<br />
	&nbsp;&nbsp; trip time out of ten packets or so. You might want to double that<br />
	&nbsp;&nbsp; for the --initial-rtt-timeout and triple or quadruple it for the<br />
	&nbsp;&nbsp; --max-rtt-timeout. I generally do not set the maximum RTT below<br />
	&nbsp;&nbsp; 100 ms, no matter what the ping times are. Nor do I exceed 1000 ms.<br />
<br />
	&nbsp;&nbsp; --min-rtt-timeout is a rarely used option that could be useful when<br />
	&nbsp;&nbsp; a network is so unreliable that even Nmap's default is too<br />
	&nbsp;&nbsp; aggressive. Since Nmap only reduces the timeout down to the minimum<br />
	&nbsp;&nbsp; when the network seems to be reliable, this need is unusual and<br />
	&nbsp;&nbsp; should be reported as a bug to the nmap-dev mailing list..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --max-retries numtries (Specify the maximum number of port scan probe<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retransmissions) .<br />
	&nbsp;&nbsp; When Nmap receives no response to a port scan probe, it could mean<br />
	&nbsp;&nbsp; the port is filtered. Or maybe the probe or response was simply<br />
	&nbsp;&nbsp; lost on the network. It is also possible that the target host has<br />
	&nbsp;&nbsp; rate limiting enabled that temporarily blocked the response. So<br />
	&nbsp;&nbsp; Nmap tries again by retransmitting the initial probe. If Nmap<br />
	&nbsp;&nbsp; detects poor network reliability, it may try many more times before<br />
	&nbsp;&nbsp; giving up on a port. While this benefits accuracy, it also lengthen<br />
	&nbsp;&nbsp; scan times. When performance is critical, scans may be sped up by<br />
	&nbsp;&nbsp; limiting the number of retransmissions allowed. You can even<br />
	&nbsp;&nbsp; specify --max-retries 0 to prevent any retransmissions, though that<br />
	&nbsp;&nbsp; is only recommended for situations such as informal surveys where<br />
	&nbsp;&nbsp; occasional missed ports and hosts are acceptable.<br />
<br />
	&nbsp;&nbsp; The default (with no -T template) is to allow ten retransmissions.<br />
	&nbsp;&nbsp; If a network seems reliable and the target hosts aren't rate<br />
	&nbsp;&nbsp; limiting, Nmap usually only does one retransmission. So most target<br />
	&nbsp;&nbsp; scans aren't even affected by dropping --max-retries to a low value<br />
	&nbsp;&nbsp; such as three. Such values can substantially speed scans of slow<br />
	&nbsp;&nbsp; (rate limited) hosts. You usually lose some information when Nmap<br />
	&nbsp;&nbsp; gives up on ports early, though that may be preferable to letting<br />
	&nbsp;&nbsp; the --host-timeout expire and losing all information about the<br />
	&nbsp;&nbsp; target.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --host-timeout time (Give up on slow target hosts) .<br />
	&nbsp;&nbsp; Some hosts simply take a long time to scan. This may be due to<br />
	&nbsp;&nbsp; poorly performing or unreliable networking hardware or software,<br />
	&nbsp;&nbsp; packet rate limiting, or a restrictive firewall. The slowest few<br />
	&nbsp;&nbsp; percent of the scanned hosts can eat up a majority of the scan<br />
	&nbsp;&nbsp; time. Sometimes it is best to cut your losses and skip those hosts<br />
	&nbsp;&nbsp; initially. Specify --host-timeout with the maximum amount of time<br />
	&nbsp;&nbsp; you are willing to wait. For example, specify 30m to ensure that<br />
	&nbsp;&nbsp; Nmap doesn't waste more than half an hour on a single host. Note<br />
	&nbsp;&nbsp; that Nmap may be scanning other hosts at the same time during that<br />
	&nbsp;&nbsp; half an hour, so it isn't a complete loss. A host that times out is<br />
	&nbsp;&nbsp; skipped. No port table, OS detection, or version detection results<br />
	&nbsp;&nbsp; are printed for that host.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --scan-delay time; --max-scan-delay time (Adjust delay between probes)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<br />
	&nbsp;&nbsp; This option causes Nmap to wait at least the given amount of time<br />
	&nbsp;&nbsp; between each probe it sends to a given host. This is particularly<br />
	&nbsp;&nbsp; useful in the case of rate limiting..&nbsp;&nbsp;Solaris machines (among many<br />
	&nbsp;&nbsp; others) will usually respond to UDP scan probe packets with only<br />
	&nbsp;&nbsp; one ICMP message per second. Any more than that sent by Nmap will<br />
	&nbsp;&nbsp; be wasteful. A --scan-delay of 1s will keep Nmap at that slow rate.<br />
	&nbsp;&nbsp; Nmap tries to detect rate limiting and adjust the scan delay<br />
	&nbsp;&nbsp; accordingly, but it doesn't hurt to specify it explicitly if you<br />
	&nbsp;&nbsp; already know what rate works best.<br />
<br />
	&nbsp;&nbsp; When Nmap adjusts the scan delay upward to cope with rate limiting,<br />
	&nbsp;&nbsp; the scan slows down dramatically. The --max-scan-delay option<br />
	&nbsp;&nbsp; specifies the largest delay that Nmap will allow. A low<br />
	&nbsp;&nbsp; --max-scan-delay can speed up Nmap, but it is risky. Setting this<br />
	&nbsp;&nbsp; value too low can lead to wasteful packet retransmissions and<br />
	&nbsp;&nbsp; possible missed ports when the target implements strict rate<br />
	&nbsp;&nbsp; limiting.<br />
<br />
	&nbsp;&nbsp; Another use of --scan-delay is to evade threshold based intrusion<br />
	&nbsp;&nbsp; detection and prevention systems (IDS/IPS)..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --min-rate number; --max-rate number (Directly control the scanning<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rate) .<br />
	&nbsp;&nbsp; Nmap's dynamic timing does a good job of finding an appropriate<br />
	&nbsp;&nbsp; speed at which to scan. Sometimes, however, you may happen to know<br />
	&nbsp;&nbsp; an appropriate scanning rate for a network, or you may have to<br />
	&nbsp;&nbsp; guarantee that a scan will be finished by a certain time. Or<br />
	&nbsp;&nbsp; perhaps you must keep Nmap from scanning too quickly. The<br />
	&nbsp;&nbsp; --min-rate and --max-rate options are designed for these<br />
	&nbsp;&nbsp; situations.<br />
<br />
	&nbsp;&nbsp; When the --min-rate option is given Nmap will do its best to send<br />
	&nbsp;&nbsp; packets as fast as or faster than the given rate. The argument is a<br />
	&nbsp;&nbsp; positive real number representing a packet rate in packets per<br />
	&nbsp;&nbsp; second. For example, specifying --min-rate 300 means that Nmap will<br />
	&nbsp;&nbsp; try to keep the sending rate at or above 300 packets per second.<br />
	&nbsp;&nbsp; Specifying a minimum rate does not keep Nmap from going faster if<br />
	&nbsp;&nbsp; conditions warrant.<br />
<br />
	&nbsp;&nbsp; Likewise, --max-rate limits a scan's sending rate to a given<br />
	&nbsp;&nbsp; maximum. Use --max-rate 100, for example, to limit sending to 100<br />
	&nbsp;&nbsp; packets per second on a fast network. Use --max-rate 0.1 for a slow<br />
	&nbsp;&nbsp; scan of one packet every ten seconds. Use --min-rate and --max-rate<br />
	&nbsp;&nbsp; together to keep the rate inside a certain range.<br />
<br />
	&nbsp;&nbsp; These two options are global, affecting an entire scan, not<br />
	&nbsp;&nbsp; individual hosts. They only affect port scans and host discovery<br />
	&nbsp;&nbsp; scans. Other features like OS detection implement their own timing.<br />
<br />
	&nbsp;&nbsp; There are two conditions when the actual scanning rate may fall<br />
	&nbsp;&nbsp; below the requested minimum. The first is if the minimum is faster<br />
	&nbsp;&nbsp; than the fastest rate at which Nmap can send, which is dependent on<br />
	&nbsp;&nbsp; hardware. In this case Nmap will simply send packets as fast as<br />
	&nbsp;&nbsp; possible, but be aware that such high rates are likely to cause a<br />
	&nbsp;&nbsp; loss of accuracy. The second case is when Nmap has nothing to send,<br />
	&nbsp;&nbsp; for example at the end of a scan when the last probes have been<br />
	&nbsp;&nbsp; sent and Nmap is waiting for them to time out or be responded to.<br />
	&nbsp;&nbsp; It's normal to see the scanning rate drop at the end of a scan or<br />
	&nbsp;&nbsp; in between hostgroups. The sending rate may temporarily exceed the<br />
	&nbsp;&nbsp; maximum to make up for unpredictable delays, but on average the<br />
	&nbsp;&nbsp; rate will stay at or below the maximum.<br />
<br />
	&nbsp;&nbsp; Specifying a minimum rate should be done with care. Scanning faster<br />
	&nbsp;&nbsp; than a network can support may lead to a loss of accuracy. In some<br />
	&nbsp;&nbsp; cases, using a faster rate can make a scan take longer than it<br />
	&nbsp;&nbsp; would with a slower rate. This is because Nmap's adaptive<br />
	&nbsp;&nbsp; retransmission algorithms will detect the network congestion caused<br />
	&nbsp;&nbsp; by an excessive scanning rate and increase the number of<br />
	&nbsp;&nbsp; retransmissions in order to improve accuracy. So even though<br />
	&nbsp;&nbsp; packets are sent at a higher rate, more packets are sent overall.<br />
	&nbsp;&nbsp; Cap the number of retransmissions with the --max-retries option if<br />
	&nbsp;&nbsp; you need to set an upper limit on total scan time.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --defeat-rst-ratelimit .<br />
	&nbsp;&nbsp; Many hosts have long used rate limiting.&nbsp;&nbsp;to reduce the number of<br />
	&nbsp;&nbsp; ICMP error messages (such as port-unreachable errors) they send.<br />
	&nbsp;&nbsp; Some systems now apply similar rate limits to the RST (reset)<br />
	&nbsp;&nbsp; packets they generate. This can slow Nmap down dramatically as it<br />
	&nbsp;&nbsp; adjusts its timing to reflect those rate limits. You can tell Nmap<br />
	&nbsp;&nbsp; to ignore those rate limits (for port scans such as SYN scan which<br />
	&nbsp;&nbsp; don't treat non-responsive ports as open) by specifying<br />
	&nbsp;&nbsp; --defeat-rst-ratelimit.<br />
<br />
	&nbsp;&nbsp; Using this option can reduce accuracy, as some ports will appear<br />
	&nbsp;&nbsp; non-responsive because Nmap didn't wait long enough for a<br />
	&nbsp;&nbsp; rate-limited RST response. With a SYN scan, the non-response<br />
	&nbsp;&nbsp; results in the port being labeled filtered rather than the closed<br />
	&nbsp;&nbsp; state we see when RST packets are received. This option is useful<br />
	&nbsp;&nbsp; when you only care about open ports, and distinguishing between<br />
	&nbsp;&nbsp; closed and filtered ports isn't worth the extra time.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --nsock-engine epoll|kqueue|poll|select .<br />
	&nbsp;&nbsp; Enforce use of a given nsock IO multiplexing engine. Only the<br />
	&nbsp;&nbsp; select(2)-based fallback engine is guaranteed to be available on<br />
	&nbsp;&nbsp; your system. Engines are named after the name of the IO management<br />
	&nbsp;&nbsp; facility they leverage. Engines currenty implemented are epoll,<br />
	&nbsp;&nbsp; kqueue, poll, and select, but not all will be present on any<br />
	&nbsp;&nbsp; platform. Use nmap -V to see which engines are supported.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -T paranoid|sneaky|polite|normal|aggressive|insane (Set a timing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; template) .<br />
	&nbsp;&nbsp; While the fine-grained timing controls discussed in the previous<br />
	&nbsp;&nbsp; section are powerful and effective, some people find them<br />
	&nbsp;&nbsp; confusing. Moreover, choosing the appropriate values can sometimes<br />
	&nbsp;&nbsp; take more time than the scan you are trying to optimize. So Nmap<br />
	&nbsp;&nbsp; offers a simpler approach, with six timing templates. You can<br />
	&nbsp;&nbsp; specify them with the -T option and their number (05) or their<br />
	&nbsp;&nbsp; name. The template names are paranoid (0), sneaky (1), polite (2),<br />
	&nbsp;&nbsp; normal (3), aggressive (4), and insane (5). The first two are for<br />
	&nbsp;&nbsp; IDS evasion. Polite mode slows down the scan to use less bandwidth<br />
	&nbsp;&nbsp; and target machine resources. Normal mode is the default and so -T3<br />
	&nbsp;&nbsp; does nothing. Aggressive mode speeds scans up by making the<br />
	&nbsp;&nbsp; assumption that you are on a reasonably fast and reliable network.<br />
	&nbsp;&nbsp; Finally insane mode.	 assumes that you are on an extraordinarily<br />
	&nbsp;&nbsp; fast network or are willing to sacrifice some accuracy for speed.<br />
<br />
	&nbsp;&nbsp; These templates allow the user to specify how aggressive they wish<br />
	&nbsp;&nbsp; to be, while leaving Nmap to pick the exact timing values. The<br />
	&nbsp;&nbsp; templates also make some minor speed adjustments for which<br />
	&nbsp;&nbsp; fine-grained control options do not currently exist. For example,<br />
	&nbsp;&nbsp; -T4.	 prohibits the dynamic scan delay from exceeding 10 ms for TCP<br />
	&nbsp;&nbsp; ports and -T5 caps that value at 5 ms. Templates can be used in<br />
	&nbsp;&nbsp; combination with fine-grained controls, and the fine-grained<br />
	&nbsp;&nbsp; controls will you specify will take precedence over the timing<br />
	&nbsp;&nbsp; template default for that parameter. I recommend using -T4 when<br />
	&nbsp;&nbsp; scanning reasonably modern and reliable networks. Keep that option<br />
	&nbsp;&nbsp; even when you add fine-grained controls so that you benefit from<br />
	&nbsp;&nbsp; those extra minor optimizations that it enables.<br />
<br />
	&nbsp;&nbsp; If you are on a decent broadband or ethernet connection, I would<br />
	&nbsp;&nbsp; recommend always using -T4. Some people love -T5 though it is too<br />
	&nbsp;&nbsp; aggressive for my taste. People sometimes specify -T2 because they<br />
	&nbsp;&nbsp; think it is less likely to crash hosts or because they consider<br />
	&nbsp;&nbsp; themselves to be polite in general. They often don't realize just<br />
	&nbsp;&nbsp; how slow -T polite.	really is. Their scan may take ten times<br />
	&nbsp;&nbsp; longer than a default scan. Machine crashes and bandwidth problems<br />
	&nbsp;&nbsp; are rare with the default timing options (-T3) and so I normally<br />
	&nbsp;&nbsp; recommend that for cautious scanners. Omitting version detection is<br />
	&nbsp;&nbsp; far more effective than playing with timing values at reducing<br />
	&nbsp;&nbsp; these problems.<br />
<br />
	&nbsp;&nbsp; While -T0.&nbsp;&nbsp;and -T1.	 may be useful for avoiding IDS alerts, they<br />
	&nbsp;&nbsp; will take an extraordinarily long time to scan thousands of<br />
	&nbsp;&nbsp; machines or ports. For such a long scan, you may prefer to set the<br />
	&nbsp;&nbsp; exact timing values you need rather than rely on the canned -T0 and<br />
	&nbsp;&nbsp; -T1 values.<br />
<br />
	&nbsp;&nbsp; The main effects of T0 are serializing the scan so only one port is<br />
	&nbsp;&nbsp; scanned at a time, and waiting five minutes between sending each<br />
	&nbsp;&nbsp; probe.&nbsp;&nbsp;T1 and T2 are similar but they only wait 15 seconds and 0.4<br />
	&nbsp;&nbsp; seconds, respectively, between probes.&nbsp;&nbsp;T3 is Nmap's default<br />
	&nbsp;&nbsp; behavior, which includes parallelization..&nbsp;&nbsp;does the equivalent of<br />
	&nbsp;&nbsp; --max-rtt-timeout 1250ms --initial-rtt-timeout 500ms --max-retries<br />
	&nbsp;&nbsp; 6 and sets the maximum TCP scan delay to 10 milliseconds.&nbsp;&nbsp;T5 does<br />
	&nbsp;&nbsp; the equivalent of --max-rtt-timeout 300ms --min-rtt-timeout 50ms<br />
	&nbsp;&nbsp; --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m as<br />
	&nbsp;&nbsp; well as setting the maximum TCP scan delay to 5 ms.<br />
<br />
FIREWALL/IDS EVASION AND SPOOFING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Many Internet pioneers envisioned a global open network with a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; universal IP address space allowing virtual connections between any two<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nodes. This allows hosts to act as true peers, serving and retrieving<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; information from each other. People could access all of their home<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; systems from work, changing the climate control settings or unlocking<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the doors for early guests. This vision of universal connectivity has<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; been stifled by address space shortages and security concerns. In the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; early 1990s, organizations began deploying firewalls for the express<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; purpose of reducing connectivity. Huge networks were cordoned off from<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the unfiltered Internet by application proxies, network address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; translation, and packet filters. The unrestricted flow of information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gave way to tight regulation of approved communication channels and the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; content that passes over them.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Network obstructions such as firewalls can make mapping a network<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exceedingly difficult. It will not get any easier, as stifling casual<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reconnaissance is often a key goal of implementing the devices.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nevertheless, Nmap offers many features to help understand these<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; complex networks, and to verify that filters are working as intended.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; It even supports mechanisms for bypassing poorly implemented defenses.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; One of the best methods of understanding your network security posture<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is to try to defeat it. Place yourself in the mind-set of an attacker,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and deploy techniques from this section against your networks. Launch<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; an FTP bounce scan, idle scan, fragmentation attack, or try to tunnel<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; through one of your own proxies.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; In addition to restricting network activity, companies are increasingly<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; monitoring traffic with intrusion detection systems (IDS). All of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; major IDSs ship with rules designed to detect Nmap scans because scans<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; are sometimes a precursor to attacks. Many of these products have<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; recently morphed into intrusion prevention systems (IPS).&nbsp;&nbsp;that<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; actively block traffic deemed malicious. Unfortunately for network<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; administrators and IDS vendors, reliably detecting bad intentions by<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; analyzing packet data is a tough problem. Attackers with patience,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; skill, and the help of certain Nmap options can usually pass by IDSs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; undetected. Meanwhile, administrators must cope with large numbers of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; false positive results where innocent activity is misdiagnosed and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alerted on or blocked.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Occasionally people suggest that Nmap should not offer features for<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; evading firewall rules or sneaking past IDSs. They argue that these<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; features are just as likely to be misused by attackers as used by<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; administrators to enhance security. The problem with this logic is that<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; these methods would still be used by attackers, who would just find<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; other tools or patch the functionality into Nmap. Meanwhile,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; administrators would find it that much harder to do their jobs.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Deploying only modern, patched FTP servers is a far more powerful<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; defense than trying to prevent the distribution of tools implementing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the FTP bounce attack.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; There is no magic bullet (or Nmap option) for detecting and subverting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; firewalls and IDS systems. It takes skill and experience. A tutorial is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; beyond the scope of this reference guide, which only lists the relevant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; options and describes what they do.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -f (fragment packets); --mtu (using the specified MTU) .<br />
	&nbsp;&nbsp; The -f option causes the requested scan (including ping scans) to<br />
	&nbsp;&nbsp; use tiny fragmented IP packets. The idea is to split up the TCP<br />
	&nbsp;&nbsp; header over several packets to make it harder for packet filters,<br />
	&nbsp;&nbsp; intrusion detection systems, and other annoyances to detect what<br />
	&nbsp;&nbsp; you are doing. Be careful with this! Some programs have trouble<br />
	&nbsp;&nbsp; handling these tiny packets. The old-school sniffer named Sniffit<br />
	&nbsp;&nbsp; segmentation faulted immediately upon receiving the first fragment.<br />
	&nbsp;&nbsp; Specify this option once, and Nmap splits the packets into eight<br />
	&nbsp;&nbsp; bytes or less after the IP header. So a 20-byte TCP header would be<br />
	&nbsp;&nbsp; split into three packets. Two with eight bytes of the TCP header,<br />
	&nbsp;&nbsp; and one with the final four. Of course each fragment also has an IP<br />
	&nbsp;&nbsp; header. Specify -f again to use 16 bytes per fragment (reducing the<br />
	&nbsp;&nbsp; number of fragments)..&nbsp;&nbsp;Or you can specify your own offset size<br />
	&nbsp;&nbsp; with the --mtu option. Don't also specify -f if you use --mtu. The<br />
	&nbsp;&nbsp; offset must be a multiple of eight. While fragmented packets won't<br />
	&nbsp;&nbsp; get by packet filters and firewalls that queue all IP fragments,<br />
	&nbsp;&nbsp; such as the CONFIG_IP_ALWAYS_DEFRAG option in the Linux kernel,<br />
	&nbsp;&nbsp; some networks can't afford the performance hit this causes and thus<br />
	&nbsp;&nbsp; leave it disabled. Others can't enable this because fragments may<br />
	&nbsp;&nbsp; take different routes into their networks. Some source systems<br />
	&nbsp;&nbsp; defragment outgoing packets in the kernel. Linux with the iptables.<br />
	&nbsp;&nbsp; connection tracking module is one such example. Do a scan while a<br />
	&nbsp;&nbsp; sniffer such as Wireshark.&nbsp;&nbsp;is running to ensure that sent packets<br />
	&nbsp;&nbsp; are fragmented. If your host OS is causing problems, try the<br />
	&nbsp;&nbsp; --send-eth.	option to bypass the IP layer and send raw ethernet<br />
	&nbsp;&nbsp; frames.<br />
<br />
	&nbsp;&nbsp; Fragmentation is only supported for Nmap's raw packet features,<br />
	&nbsp;&nbsp; which includes TCP and UDP port scans (except connect scan and FTP<br />
	&nbsp;&nbsp; bounce scan) and OS detection. Features such as version detection<br />
	&nbsp;&nbsp; and the Nmap Scripting Engine generally don't support fragmentation<br />
	&nbsp;&nbsp; because they rely on your host's TCP stack to communicate with<br />
	&nbsp;&nbsp; target services.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -D decoy1[,decoy2][,ME][,...] (Cloak a scan with decoys) .<br />
	&nbsp;&nbsp; Causes a decoy scan to be performed, which makes it appear to the<br />
	&nbsp;&nbsp; remote host that the host(s) you specify as decoys are scanning the<br />
	&nbsp;&nbsp; target network too. Thus their IDS might report 510 port scans<br />
	&nbsp;&nbsp; from unique IP addresses, but they won't know which IP was scanning<br />
	&nbsp;&nbsp; them and which were innocent decoys. While this can be defeated<br />
	&nbsp;&nbsp; through router path tracing, response-dropping, and other active<br />
	&nbsp;&nbsp; mechanisms, it is generally an effective technique for hiding your<br />
	&nbsp;&nbsp; IP address.<br />
<br />
	&nbsp;&nbsp; Separate each decoy host with commas, and you can optionally use<br />
	&nbsp;&nbsp; ME.	as one of the decoys to represent the position for your real<br />
	&nbsp;&nbsp; IP address. If you put ME in the sixth position or later, some<br />
	&nbsp;&nbsp; common port scan detectors (such as Solar Designer's.&nbsp;&nbsp;excellent<br />
	&nbsp;&nbsp; Scanlogd).&nbsp;&nbsp;are unlikely to show your IP address at all. If you<br />
	&nbsp;&nbsp; don't use ME, Nmap will put you in a random position. You can also<br />
	&nbsp;&nbsp; use RND.&nbsp;&nbsp;to generate a random, non-reserved IP address, or<br />
	&nbsp;&nbsp; RND:number to generate number addresses.<br />
<br />
	&nbsp;&nbsp; Note that the hosts you use as decoys should be up or you might<br />
	&nbsp;&nbsp; accidentally SYN flood your targets. Also it will be pretty easy to<br />
	&nbsp;&nbsp; determine which host is scanning if only one is actually up on the<br />
	&nbsp;&nbsp; network. You might want to use IP addresses instead of names (so<br />
	&nbsp;&nbsp; the decoy networks don't see you in their nameserver logs).<br />
<br />
	&nbsp;&nbsp; Decoys are used both in the initial ping scan (using ICMP, SYN,<br />
	&nbsp;&nbsp; ACK, or whatever) and during the actual port scanning phase. Decoys<br />
	&nbsp;&nbsp; are also used during remote OS detection (-O). Decoys do not work<br />
	&nbsp;&nbsp; with version detection or TCP connect scan. When a scan delay is in<br />
	&nbsp;&nbsp; effect, the delay is enforced between each batch of spoofed probes,<br />
	&nbsp;&nbsp; not between each individual probe. Because decoys are sent as a<br />
	&nbsp;&nbsp; batch all at once, they may temporarily violate congestion control<br />
	&nbsp;&nbsp; limits.<br />
<br />
	&nbsp;&nbsp; It is worth noting that using too many decoys may slow your scan<br />
	&nbsp;&nbsp; and potentially even make it less accurate. Also, some ISPs will<br />
	&nbsp;&nbsp; filter out your spoofed packets, but many do not restrict spoofed<br />
	&nbsp;&nbsp; IP packets at all.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -S IP_Address (Spoof source address) .<br />
	&nbsp;&nbsp; In some circumstances, Nmap may not be able to determine your<br />
	&nbsp;&nbsp; source address (Nmap will tell you if this is the case). In this<br />
	&nbsp;&nbsp; situation, use -S with the IP address of the interface you wish to<br />
	&nbsp;&nbsp; send packets through.<br />
<br />
	&nbsp;&nbsp; Another possible use of this flag is to spoof the scan to make the<br />
	&nbsp;&nbsp; targets think that someone else is scanning them. Imagine a company<br />
	&nbsp;&nbsp; being repeatedly port scanned by a competitor! The -e option and<br />
	&nbsp;&nbsp; -Pn are generally required for this sort of usage. Note that you<br />
	&nbsp;&nbsp; usually won't receive reply packets back (they will be addressed to<br />
	&nbsp;&nbsp; the IP you are spoofing), so Nmap won't produce useful reports.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -e interface (Use specified interface) .<br />
	&nbsp;&nbsp; Tells Nmap what interface to send and receive packets on. Nmap<br />
	&nbsp;&nbsp; should be able to detect this automatically, but it will tell you<br />
	&nbsp;&nbsp; if it cannot.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --source-port portnumber; -g portnumber (Spoof source port number) .<br />
	&nbsp;&nbsp; One surprisingly common misconfiguration is to trust traffic based<br />
	&nbsp;&nbsp; only on the source port number. It is easy to understand how this<br />
	&nbsp;&nbsp; comes about. An administrator will set up a shiny new firewall,<br />
	&nbsp;&nbsp; only to be flooded with complaints from ungrateful users whose<br />
	&nbsp;&nbsp; applications stopped working. In particular, DNS may be broken<br />
	&nbsp;&nbsp; because the UDP DNS replies from external servers can no longer<br />
	&nbsp;&nbsp; enter the network. FTP is another common example. In active FTP<br />
	&nbsp;&nbsp; transfers, the remote server tries to establish a connection back<br />
	&nbsp;&nbsp; to the client to transfer the requested file.<br />
<br />
	&nbsp;&nbsp; Secure solutions to these problems exist, often in the form of<br />
	&nbsp;&nbsp; application-level proxies or protocol-parsing firewall modules.<br />
	&nbsp;&nbsp; Unfortunately there are also easier, insecure solutions. Noting<br />
	&nbsp;&nbsp; that DNS replies come from port 53 and active FTP from port 20,<br />
	&nbsp;&nbsp; many administrators have fallen into the trap of simply allowing<br />
	&nbsp;&nbsp; incoming traffic from those ports. They often assume that no<br />
	&nbsp;&nbsp; attacker would notice and exploit such firewall holes. In other<br />
	&nbsp;&nbsp; cases, administrators consider this a short-term stop-gap measure<br />
	&nbsp;&nbsp; until they can implement a more secure solution. Then they forget<br />
	&nbsp;&nbsp; the security upgrade.<br />
<br />
	&nbsp;&nbsp; Overworked network administrators are not the only ones to fall<br />
	&nbsp;&nbsp; into this trap. Numerous products have shipped with these insecure<br />
	&nbsp;&nbsp; rules. Even Microsoft has been guilty. The IPsec filters that<br />
	&nbsp;&nbsp; shipped with Windows 2000 and Windows XP contain an implicit rule<br />
	&nbsp;&nbsp; that allows all TCP or UDP traffic from port 88 (Kerberos). In<br />
	&nbsp;&nbsp; another well-known case, versions of the Zone Alarm personal<br />
	&nbsp;&nbsp; firewall up to 2.1.25 allowed any incoming UDP packets with the<br />
	&nbsp;&nbsp; source port 53 (DNS) or 67 (DHCP).<br />
<br />
	&nbsp;&nbsp; Nmap offers the -g and --source-port options (they are equivalent)<br />
	&nbsp;&nbsp; to exploit these weaknesses. Simply provide a port number and Nmap<br />
	&nbsp;&nbsp; will send packets from that port where possible. Most scanning<br />
	&nbsp;&nbsp; operations that use raw sockets, including SYN and UDP scans,<br />
	&nbsp;&nbsp; support the option completely. The option notably doesn't have an<br />
	&nbsp;&nbsp; effect for any operations that use normal operating system sockets,<br />
	&nbsp;&nbsp; including DNS requests, TCP connect scan,.&nbsp;&nbsp;version detection, and<br />
	&nbsp;&nbsp; script scanning. Setting the source port also doesn't work for OS<br />
	&nbsp;&nbsp; detection, because Nmap must use different port numbers for certain<br />
	&nbsp;&nbsp; OS detection tests to work properly.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --data-length number (Append random data to sent packets) .<br />
	&nbsp;&nbsp; Normally Nmap sends minimalist packets containing only a header. So<br />
	&nbsp;&nbsp; its TCP packets are generally 40 bytes and ICMP echo requests are<br />
	&nbsp;&nbsp; just 28. Some UDP ports.&nbsp;&nbsp;and IP protocols.	get a custom payload<br />
	&nbsp;&nbsp; by default. This option tells Nmap to append the given number of<br />
	&nbsp;&nbsp; random bytes to most of the packets it sends, and not to use any<br />
	&nbsp;&nbsp; protocol-specific payloads. (Use --data-length 0 for no random or<br />
	&nbsp;&nbsp; protocol-specific payloads..	 OS detection (-O) packets are not<br />
	&nbsp;&nbsp; affected.&nbsp;&nbsp;because accuracy there requires probe consistency, but<br />
	&nbsp;&nbsp; most pinging and portscan packets support this. It slows things<br />
	&nbsp;&nbsp; down a little, but can make a scan slightly less conspicuous.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --ip-options S|R [route]|L [route]|T|U ... ; --ip-options hex string<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (Send packets with specified ip options) .<br />
	&nbsp;&nbsp; The IP protocol[13] offers several options which may be placed in<br />
	&nbsp;&nbsp; packet headers. Unlike the ubiquitous TCP options, IP options are<br />
	&nbsp;&nbsp; rarely seen due to practicality and security concerns. In fact,<br />
	&nbsp;&nbsp; many Internet routers block the most dangerous options such as<br />
	&nbsp;&nbsp; source routing. Yet options can still be useful in some cases for<br />
	&nbsp;&nbsp; determining and manipulating the network route to target machines.<br />
	&nbsp;&nbsp; For example, you may be able to use the record route option to<br />
	&nbsp;&nbsp; determine a path to a target even when more traditional<br />
	&nbsp;&nbsp; traceroute-style approaches fail. Or if your packets are being<br />
	&nbsp;&nbsp; dropped by a certain firewall, you may be able to specify a<br />
	&nbsp;&nbsp; different route with the strict or loose source routing options.<br />
<br />
	&nbsp;&nbsp; The most powerful way to specify IP options is to simply pass in<br />
	&nbsp;&nbsp; values as the argument to --ip-options. Precede each hex number<br />
	&nbsp;&nbsp; with \x then the two digits. You may repeat certain characters by<br />
	&nbsp;&nbsp; following them with an asterisk and then the number of times you<br />
	&nbsp;&nbsp; wish them to repeat. For example, \x01\x07\x04\x00*36\x01 is a hex<br />
	&nbsp;&nbsp; string containing 36 NUL bytes.<br />
<br />
	&nbsp;&nbsp; Nmap also offers a shortcut mechanism for specifying options.<br />
	&nbsp;&nbsp; Simply pass the letter R, T, or U to request record-route,.<br />
	&nbsp;&nbsp; record-timestamp,.&nbsp;&nbsp;or both options together, respectively. Loose<br />
	&nbsp;&nbsp; or strict source routing.&nbsp;&nbsp;may be specified with an L or S followed<br />
	&nbsp;&nbsp; by a space and then a space-separated list of IP addresses.<br />
<br />
	&nbsp;&nbsp; If you wish to see the options in packets sent and received,<br />
	&nbsp;&nbsp; specify --packet-trace. For more information and examples of using<br />
	&nbsp;&nbsp; IP options with Nmap, see http://seclists.org/nmap-dev/2006/q3/52.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --ttl value (Set IP time-to-live field) .<br />
	&nbsp;&nbsp; Sets the IPv4 time-to-live field in sent packets to the given<br />
	&nbsp;&nbsp; value.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --randomize-hosts (Randomize target host order) .<br />
	&nbsp;&nbsp; Tells Nmap to shuffle each group of up to 16384 hosts before it<br />
	&nbsp;&nbsp; scans them. This can make the scans less obvious to various network<br />
	&nbsp;&nbsp; monitoring systems, especially when you combine it with slow timing<br />
	&nbsp;&nbsp; options. If you want to randomize over larger group sizes, increase<br />
	&nbsp;&nbsp; PING_GROUP_SZ.&nbsp;&nbsp;in nmap.h.&nbsp;&nbsp;and recompile. An alternative solution<br />
	&nbsp;&nbsp; is to generate the target IP list with a list scan (-sL -n -oN<br />
	&nbsp;&nbsp; filename), randomize it with a Perl script, then provide the whole<br />
	&nbsp;&nbsp; list to Nmap with -iL..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --spoof-mac MAC address, prefix, or vendor name (Spoof MAC address) .<br />
	&nbsp;&nbsp; Asks Nmap to use the given MAC address for all of the raw ethernet<br />
	&nbsp;&nbsp; frames it sends. This option implies --send-eth.&nbsp;&nbsp;to ensure that<br />
	&nbsp;&nbsp; Nmap actually sends ethernet-level packets. The MAC given can take<br />
	&nbsp;&nbsp; several formats. If it is simply the number 0, Nmap chooses a<br />
	&nbsp;&nbsp; completely random MAC address for the session. If the given string<br />
	&nbsp;&nbsp; is an even number of hex digits (with the pairs optionally<br />
	&nbsp;&nbsp; separated by a colon), Nmap will use those as the MAC. If fewer<br />
	&nbsp;&nbsp; than 12 hex digits are provided, Nmap fills in the remainder of the<br />
	&nbsp;&nbsp; six bytes with random values. If the argument isn't a zero or hex<br />
	&nbsp;&nbsp; string, Nmap looks through nmap-mac-prefixes to find a vendor name<br />
	&nbsp;&nbsp; containing the given string (it is case insensitive). If a match is<br />
	&nbsp;&nbsp; found, Nmap uses the vendor's OUI (three-byte prefix).&nbsp;&nbsp;and fills<br />
	&nbsp;&nbsp; out the remaining three bytes randomly. Valid --spoof-mac argument<br />
	&nbsp;&nbsp; examples are Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2, and<br />
	&nbsp;&nbsp; Cisco. This option only affects raw packet scans such as SYN scan<br />
	&nbsp;&nbsp; or OS detection, not connection-oriented features such as version<br />
	&nbsp;&nbsp; detection or the Nmap Scripting Engine.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --badsum (Send packets with bogus TCP/UDP checksums) .<br />
	&nbsp;&nbsp; Asks Nmap to use an invalid TCP, UDP or SCTP checksum for packets<br />
	&nbsp;&nbsp; sent to target hosts. Since virtually all host IP stacks properly<br />
	&nbsp;&nbsp; drop these packets, any responses received are likely coming from a<br />
	&nbsp;&nbsp; firewall or IDS that didn't bother to verify the checksum. For more<br />
	&nbsp;&nbsp; details on this technique, see http://nmap.org/p60-12.html<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --adler32 (Use deprecated Adler32 instead of CRC32C for SCTP checksums)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<br />
	&nbsp;&nbsp; Asks Nmap to use the deprecated Adler32 algorithm for calculating<br />
	&nbsp;&nbsp; the SCTP checksum. If --adler32 is not given, CRC-32C (Castagnoli)<br />
	&nbsp;&nbsp; is used.&nbsp;&nbsp;RFC 2960[14] originally defined Adler32 as checksum<br />
	&nbsp;&nbsp; algorithm for SCTP; RFC 4960[7] later redefined the SCTP checksums<br />
	&nbsp;&nbsp; to use CRC-32C. Current SCTP implementations should be using<br />
	&nbsp;&nbsp; CRC-32C, but in order to elicit responses from old, legacy SCTP<br />
	&nbsp;&nbsp; implementations, it may be preferable to use Adler32.<br />
<br />
OUTPUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Any security tool is only as useful as the output it generates. Complex<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tests and algorithms are of little value if they aren't presented in an<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; organized and comprehensible fashion. Given the number of ways Nmap is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; used by people and other software, no single format can please<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; everyone. So Nmap offers several formats, including the interactive<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mode for humans to read directly and XML for easy parsing by software.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; In addition to offering different output formats, Nmap provides options<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for controlling the verbosity of output as well as debugging messages.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Output types may be sent to standard output or to named files, which<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap can append to or clobber. Output files may also be used to resume<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aborted scans.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap makes output available in five different formats. The default is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; called interactive output,.&nbsp;&nbsp;and it is sent to standard output<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (stdout)..&nbsp;&nbsp;There is also normal output,.&nbsp;&nbsp;which is similar to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; interactive except that it displays less runtime information and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; warnings since it is expected to be analyzed after the scan completes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rather than interactively.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XML output.&nbsp;&nbsp;is one of the most important output types, as it can be<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; converted to HTML, easily parsed by programs such as Nmap graphical<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user interfaces, or imported into databases.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The two remaining output types are the simple grepable output.&nbsp;&nbsp;which<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; includes most information for a target host on a single line, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sCRiPt KiDDi3 0utPUt.&nbsp;&nbsp;for users who consider themselves |&lt;-r4d.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While interactive output is the default and has no associated<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; command-line options, the other four format options use the same<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; syntax. They take one argument, which is the filename that results<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; should be stored in. Multiple formats may be specified, but each format<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; may only be specified once. For example, you may wish to save normal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output for your own review while saving XML of the same scan for<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; programmatic analysis. You might do this with the options -oX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myscan.xml -oN myscan.nmap. While this chapter uses the simple names<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; like myscan.xml for brevity, more descriptive names are generally<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; recommended. The names chosen are a matter of personal preference,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; though I use long ones that incorporate the scan date and a word or two<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; describing the scan, placed in a directory named after the company I'm<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanning.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While these options save results to files, Nmap still prints<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; interactive output to stdout as usual. For example, the command nmap<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -oX myscan.xml target prints XML to myscan.xml and fills standard<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output with the same interactive results it would have printed if -oX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wasn't specified at all. You can change this by passing a hyphen<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; character as the argument to one of the format types. This causes Nmap<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to deactivate interactive output, and instead print results in the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; format you specified to the standard output stream. So the command nmap<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -oX - target will send only XML output to stdout..&nbsp;&nbsp;Serious errors may<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; still be printed to the normal error stream, stderr..<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Unlike some Nmap arguments, the space between the logfile option flag<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (such as -oX) and the filename or hyphen is mandatory. If you omit the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; flags and give arguments such as -oG- or -oXscan.xml, a backwards<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; compatibility feature of Nmap will cause the creation of normal format<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output files named G- and Xscan.xml respectively.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; All of these arguments support strftime-like.&nbsp;&nbsp;conversions in the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filename.&nbsp;&nbsp;%H, %M, %S, %m, %d, %y, and %Y are all exactly the same as<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in strftime.&nbsp;&nbsp;%T is the same as %H%M%S, %R is the same as %H%M, and %D<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is the same as %m%d%y. A % followed by any other character just yields<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; that character (%% gives you a percent symbol). So -oX 'scan-%T-%D.xml'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; will use an XML file with a name in the form of scan-144840-121307.xml.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap also offers options to control scan verbosity and to append to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output files rather than clobbering them. All of these options are<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; described below.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap Output Formats<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -oN filespec (normal output) .<br />
	&nbsp;&nbsp; Requests that normal output be directed to the given filename. As<br />
	&nbsp;&nbsp; discussed above, this differs slightly from interactive output.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -oX filespec (XML output) .<br />
	&nbsp;&nbsp; Requests that XML output be directed to the given filename. Nmap<br />
	&nbsp;&nbsp; includes a document type definition (DTD) which allows XML parsers<br />
	&nbsp;&nbsp; to validate Nmap XML output. While it is primarily intended for<br />
	&nbsp;&nbsp; programmatic use, it can also help humans interpret Nmap XML<br />
	&nbsp;&nbsp; output. The DTD defines the legal elements of the format, and often<br />
	&nbsp;&nbsp; enumerates the attributes and values they can take on. The latest<br />
	&nbsp;&nbsp; version is always available from<br />
	&nbsp;&nbsp; https://svn.nmap.org/nmap/docs/nmap.dtd.<br />
<br />
	&nbsp;&nbsp; XML offers a stable format that is easily parsed by software. Free<br />
	&nbsp;&nbsp; XML parsers are available for all major computer languages,<br />
	&nbsp;&nbsp; including C/C++, Perl, Python, and Java. People have even written<br />
	&nbsp;&nbsp; bindings for most of these languages to handle Nmap output and<br />
	&nbsp;&nbsp; execution specifically. Examples are Nmap::Scanner[15].&nbsp;&nbsp;and<br />
	&nbsp;&nbsp; Nmap::Parser[16].&nbsp;&nbsp;in Perl CPAN. In almost all cases that a<br />
	&nbsp;&nbsp; non-trivial application interfaces with Nmap, XML is the preferred<br />
	&nbsp;&nbsp; format.<br />
<br />
	&nbsp;&nbsp; The XML output references an XSL stylesheet which can be used to<br />
	&nbsp;&nbsp; format the results as HTML. The easiest way to use this is simply<br />
	&nbsp;&nbsp; to load the XML output in a web browser such as Firefox or IE. By<br />
	&nbsp;&nbsp; default, this will only work on the machine you ran Nmap on (or a<br />
	&nbsp;&nbsp; similarly configured one) due to the hard-coded nmap.xsl filesystem<br />
	&nbsp;&nbsp; path. Use the --webxml or --stylesheet options to create portable<br />
	&nbsp;&nbsp; XML files that render as HTML on any web-connected machine.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -oS filespec (ScRipT KIdd|3 oUTpuT) .<br />
	&nbsp;&nbsp; Script kiddie output is like interactive output, except that it is<br />
	&nbsp;&nbsp; post-processed to better suit the l33t HaXXorZ who previously<br />
	&nbsp;&nbsp; looked down on Nmap due to its consistent capitalization and<br />
	&nbsp;&nbsp; spelling. Humor impaired people should note that this option is<br />
	&nbsp;&nbsp; making fun of the script kiddies before flaming me for supposedly<br />
	&nbsp;&nbsp; "helping them".<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -oG filespec (grepable output) .<br />
	&nbsp;&nbsp; This output format is covered last because it is deprecated. The<br />
	&nbsp;&nbsp; XML output format is far more powerful, and is nearly as convenient<br />
	&nbsp;&nbsp; for experienced users. XML is a standard for which dozens of<br />
	&nbsp;&nbsp; excellent parsers are available, while grepable output is my own<br />
	&nbsp;&nbsp; simple hack. XML is extensible to support new Nmap features as they<br />
	&nbsp;&nbsp; are released, while I often must omit those features from grepable<br />
	&nbsp;&nbsp; output for lack of a place to put them.<br />
<br />
	&nbsp;&nbsp; Nevertheless, grepable output is still quite popular. It is a<br />
	&nbsp;&nbsp; simple format that lists each host on one line and can be trivially<br />
	&nbsp;&nbsp; searched and parsed with standard Unix tools such as grep, awk,<br />
	&nbsp;&nbsp; cut, sed, diff, and Perl. Even I usually use it for one-off tests<br />
	&nbsp;&nbsp; done at the command line. Finding all the hosts with the SSH port<br />
	&nbsp;&nbsp; open or that are running Solaris takes only a simple grep to<br />
	&nbsp;&nbsp; identify the hosts, piped to an awk or cut command to print the<br />
	&nbsp;&nbsp; desired fields.<br />
<br />
	&nbsp;&nbsp; Grepable output consists of comments (lines starting with a pound<br />
	&nbsp;&nbsp; (#)).&nbsp;&nbsp;and target lines. A target line includes a combination of<br />
	&nbsp;&nbsp; six labeled fields, separated by tabs and followed with a colon.<br />
	&nbsp;&nbsp; The fields are Host, Ports, Protocols, Ignored State, OS, Seq<br />
	&nbsp;&nbsp; Index, IP ID, and Status.<br />
<br />
	&nbsp;&nbsp; The most important of these fields is generally Ports, which gives<br />
	&nbsp;&nbsp; details on each interesting port. It is a comma separated list of<br />
	&nbsp;&nbsp; port entries. Each port entry represents one interesting port, and<br />
	&nbsp;&nbsp; takes the form of seven slash (/) separated subfields. Those<br />
	&nbsp;&nbsp; subfields are: Port number, State, Protocol, Owner, Service, SunRPC<br />
	&nbsp;&nbsp; info, and Version info.<br />
<br />
	&nbsp;&nbsp; As with XML output, this man page does not allow for documenting<br />
	&nbsp;&nbsp; the entire format. A more detailed look at the Nmap grepable output<br />
	&nbsp;&nbsp; format is available from<br />
	&nbsp;&nbsp; http://nmap.org/book/output-formats-grepable-output.html.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -oA basename (Output to all formats) .<br />
	&nbsp;&nbsp; As a convenience, you may specify -oA basename to store scan<br />
	&nbsp;&nbsp; results in normal, XML, and grepable formats at once. They are<br />
	&nbsp;&nbsp; stored in basename.nmap, basename.xml, and basename.gnmap,<br />
	&nbsp;&nbsp; respectively. As with most programs, you can prefix the filenames<br />
	&nbsp;&nbsp; with a directory path, such as ~/nmaplogs/foocorp/ on Unix or<br />
	&nbsp;&nbsp; c:\hacking\sco on Windows.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Verbosity and debugging options<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -v (Increase verbosity level) .<br />
	&nbsp;&nbsp; Increases the verbosity level, causing Nmap to print more<br />
	&nbsp;&nbsp; information about the scan in progress. Open ports are shown as<br />
	&nbsp;&nbsp; they are found and completion time estimates are provided when Nmap<br />
	&nbsp;&nbsp; thinks a scan will take more than a few minutes. Use it twice or<br />
	&nbsp;&nbsp; more for even greater verbosity: -vv, or give a verbosity level<br />
	&nbsp;&nbsp; directly, for example -v3..<br />
<br />
	&nbsp;&nbsp; Most changes only affect interactive output, and some also affect<br />
	&nbsp;&nbsp; normal and script kiddie output. The other output types are meant<br />
	&nbsp;&nbsp; to be processed by machines, so Nmap can give substantial detail by<br />
	&nbsp;&nbsp; default in those formats without fatiguing a human user. However,<br />
	&nbsp;&nbsp; there are a few changes in other modes where output size can be<br />
	&nbsp;&nbsp; reduced substantially by omitting some detail. For example, a<br />
	&nbsp;&nbsp; comment line in the grepable output that provides a list of all<br />
	&nbsp;&nbsp; ports scanned is only printed in verbose mode because it can be<br />
	&nbsp;&nbsp; quite long.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -d (Increase debugging level) .<br />
	&nbsp;&nbsp; When even verbose mode doesn't provide sufficient data for you,<br />
	&nbsp;&nbsp; debugging is available to flood you with much more! As with the<br />
	&nbsp;&nbsp; verbosity option (-v), debugging is enabled with a command-line<br />
	&nbsp;&nbsp; flag (-d) and the debug level can be increased by specifying it<br />
	&nbsp;&nbsp; multiple times,.&nbsp;&nbsp;as in -dd, or by setting a level directly. For<br />
	&nbsp;&nbsp; example, -d9 sets level nine. That is the highest effective level<br />
	&nbsp;&nbsp; and will produce thousands of lines unless you run a very simple<br />
	&nbsp;&nbsp; scan with very few ports and targets.<br />
<br />
	&nbsp;&nbsp; Debugging output is useful when a bug is suspected in Nmap, or if<br />
	&nbsp;&nbsp; you are simply confused as to what Nmap is doing and why. As this<br />
	&nbsp;&nbsp; feature is mostly intended for developers, debug lines aren't<br />
	&nbsp;&nbsp; always self-explanatory. You may get something like: Timeout vals:<br />
	&nbsp;&nbsp; srtt: -1 rttvar: -1 to: 1000000 delta 14987 ==&gt; srtt: 14987 rttvar:<br />
	&nbsp;&nbsp; 14987 to: 100000. If you don't understand a line, your only<br />
	&nbsp;&nbsp; recourses are to ignore it, look it up in the source code, or<br />
	&nbsp;&nbsp; request help from the development list (nmap-dev)..	Some lines are<br />
	&nbsp;&nbsp; self explanatory, but the messages become more obscure as the debug<br />
	&nbsp;&nbsp; level is increased.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --reason (Host and port state reasons) .<br />
	&nbsp;&nbsp; Shows the reason each port is set to a specific state and the<br />
	&nbsp;&nbsp; reason each host is up or down. This option displays the type of<br />
	&nbsp;&nbsp; the packet that determined a port or hosts state. For example, A<br />
	&nbsp;&nbsp; RST packet from a closed port or an echo reply from an alive host.<br />
	&nbsp;&nbsp; The information Nmap can provide is determined by the type of scan<br />
	&nbsp;&nbsp; or ping. The SYN scan and SYN ping (-sS and -PS) are very detailed,<br />
	&nbsp;&nbsp; but the TCP connect scan (-sT) is limited by the implementation of<br />
	&nbsp;&nbsp; the connect system call. This feature is automatically enabled by<br />
	&nbsp;&nbsp; the debug option (-d).&nbsp;&nbsp;and the results are stored in XML log files<br />
	&nbsp;&nbsp; even if this option is not specified.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --stats-every time (Print periodic timing stats) .<br />
	&nbsp;&nbsp; Periodically prints a timing status message after each interval of<br />
	&nbsp;&nbsp; time. The time is a specification of the kind described in the<br />
	&nbsp;&nbsp; section called "TIMING AND PERFORMANCE"; so for example, use<br />
	&nbsp;&nbsp; --stats-every 10s to get a status update every 10 seconds. Updates<br />
	&nbsp;&nbsp; are printed to interactive output (the screen) and XML output.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --packet-trace (Trace packets and data sent and received) .<br />
	&nbsp;&nbsp; Causes Nmap to print a summary of every packet sent or received.<br />
	&nbsp;&nbsp; This is often used for debugging, but is also a valuable way for<br />
	&nbsp;&nbsp; new users to understand exactly what Nmap is doing under the<br />
	&nbsp;&nbsp; covers. To avoid printing thousands of lines, you may want to<br />
	&nbsp;&nbsp; specify a limited number of ports to scan, such as -p20-30. If you<br />
	&nbsp;&nbsp; only care about the goings on of the version detection subsystem,<br />
	&nbsp;&nbsp; use --version-trace instead. If you only care about script tracing,<br />
	&nbsp;&nbsp; specify --script-trace. With --packet-trace, you get all of the<br />
	&nbsp;&nbsp; above.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --open (Show only open (or possibly open) ports) .<br />
	&nbsp;&nbsp; Sometimes you only care about ports you can actually connect to<br />
	&nbsp;&nbsp; (open ones), and don't want results cluttered with closed,<br />
	&nbsp;&nbsp; filtered, and closed|filtered ports. Output customization is<br />
	&nbsp;&nbsp; normally done after the scan using tools such as grep, awk, and<br />
	&nbsp;&nbsp; Perl, but this feature was added due to overwhelming requests.<br />
	&nbsp;&nbsp; Specify --open to only see hosts with at least one open,<br />
	&nbsp;&nbsp; open|filtered, or unfiltered port, and only see ports in those<br />
	&nbsp;&nbsp; states. These three states are treated just as they normally are,<br />
	&nbsp;&nbsp; which means that open|filtered and unfiltered may be condensed into<br />
	&nbsp;&nbsp; counts if there are an overwhelming number of them.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --iflist (List interfaces and routes) .<br />
	&nbsp;&nbsp; Prints the interface list and system routes as detected by Nmap.<br />
	&nbsp;&nbsp; This is useful for debugging routing problems or device<br />
	&nbsp;&nbsp; mischaracterization (such as Nmap treating a PPP connection as<br />
	&nbsp;&nbsp; ethernet).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Miscellaneous output options<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --append-output (Append to rather than clobber output files) .<br />
	&nbsp;&nbsp; When you specify a filename to an output format flag such as -oX or<br />
	&nbsp;&nbsp; -oN, that file is overwritten by default. If you prefer to keep the<br />
	&nbsp;&nbsp; existing content of the file and append the new results, specify<br />
	&nbsp;&nbsp; the --append-output option. All output filenames specified in that<br />
	&nbsp;&nbsp; Nmap execution will then be appended to rather than clobbered. This<br />
	&nbsp;&nbsp; doesn't work well for XML (-oX) scan data as the resultant file<br />
	&nbsp;&nbsp; generally won't parse properly until you fix it up by hand.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --resume filename (Resume aborted scan) .<br />
	&nbsp;&nbsp; Some extensive Nmap runs take a very long timeon the order of<br />
	&nbsp;&nbsp; days. Such scans don't always run to completion. Restrictions may<br />
	&nbsp;&nbsp; prevent Nmap from being run during working hours, the network could<br />
	&nbsp;&nbsp; go down, the machine Nmap is running on might suffer a planned or<br />
	&nbsp;&nbsp; unplanned reboot, or Nmap itself could crash. The administrator<br />
	&nbsp;&nbsp; running Nmap could cancel it for any other reason as well, by<br />
	&nbsp;&nbsp; pressing ctrl-C. Restarting the whole scan from the beginning may<br />
	&nbsp;&nbsp; be undesirable. Fortunately, if normal (-oN) or grepable (-oG) logs<br />
	&nbsp;&nbsp; were kept, the user can ask Nmap to resume scanning with the target<br />
	&nbsp;&nbsp; it was working on when execution ceased. Simply specify the<br />
	&nbsp;&nbsp; --resume option and pass the normal/grepable output file as its<br />
	&nbsp;&nbsp; argument. No other arguments are permitted, as Nmap parses the<br />
	&nbsp;&nbsp; output file to use the same ones specified previously. Simply call<br />
	&nbsp;&nbsp; Nmap as nmap --resume logfilename. Nmap will append new results to<br />
	&nbsp;&nbsp; the data files specified in the previous execution. Resumption does<br />
	&nbsp;&nbsp; not support the XML output format because combining the two runs<br />
	&nbsp;&nbsp; into one valid XML file would be difficult.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --stylesheet path or URL (Set XSL stylesheet to transform XML output) .<br />
	&nbsp;&nbsp; Nmap ships with an XSL.&nbsp;&nbsp;stylesheet.	 named nmap.xsl.&nbsp;&nbsp;for viewing<br />
	&nbsp;&nbsp; or translating XML output to HTML..	The XML output includes an<br />
	&nbsp;&nbsp; xml-stylesheet directive which points to nmap.xml where it was<br />
	&nbsp;&nbsp; initially installed by Nmap. Run the XML file through an XSLT<br />
	&nbsp;&nbsp; processor such as xsltproc[17].&nbsp;&nbsp;to produce an HTML file. Directly<br />
	&nbsp;&nbsp; opening the XML file in a browser no longer works well because<br />
	&nbsp;&nbsp; modern browsers limit the locations a stylesheet may be loaded<br />
	&nbsp;&nbsp; from. If you wish to use a different stylesheet, specify it as the<br />
	&nbsp;&nbsp; argument to --stylesheet. You must pass the full pathname or URL.<br />
	&nbsp;&nbsp; One common invocation is --stylesheet<br />
	&nbsp;&nbsp; http://nmap.org/svn/docs/nmap.xsl. This tells an XSLT processor to<br />
	&nbsp;&nbsp; load the latest version of the stylesheet from Nmap.Org. The<br />
	&nbsp;&nbsp; --webxml option does the same thing with less typing and<br />
	&nbsp;&nbsp; memorization. Loading the XSL from Nmap.Org makes it easier to view<br />
	&nbsp;&nbsp; results on a machine that doesn't have Nmap (and thus nmap.xsl)<br />
	&nbsp;&nbsp; installed. So the URL is often more useful, but the local<br />
	&nbsp;&nbsp; filesystem location of nmap.xsl is used by default for privacy<br />
	&nbsp;&nbsp; reasons.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --webxml (Load stylesheet from Nmap.Org) .<br />
	&nbsp;&nbsp; This is a convenience option, nothing more than an alias for<br />
	&nbsp;&nbsp; --stylesheet http://nmap.org/svn/docs/nmap.xsl.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --no-stylesheet (Omit XSL stylesheet declaration from XML) .<br />
	&nbsp;&nbsp; Specify this option to prevent Nmap from associating any XSL<br />
	&nbsp;&nbsp; stylesheet with its XML output. The xml-stylesheet directive is<br />
	&nbsp;&nbsp; omitted.<br />
<br />
MISCELLANEOUS OPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This section describes some important (and not-so-important) options<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; that don't really fit anywhere else.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -6 (Enable IPv6 scanning) .<br />
	&nbsp;&nbsp; Nmap has IPv6 support for its most popular features. Ping scanning,<br />
	&nbsp;&nbsp; port scanning, version detection, and the Nmap Scripting Engine all<br />
	&nbsp;&nbsp; support IPv6. The command syntax is the same as usual except that<br />
	&nbsp;&nbsp; you also add the -6 option. Of course, you must use IPv6 syntax if<br />
	&nbsp;&nbsp; you specify an address rather than a hostname. An address might<br />
	&nbsp;&nbsp; look like 3ffe:7501:4819:2000:210:f3ff:fe03:14d0, so hostnames are<br />
	&nbsp;&nbsp; recommended. The output looks the same as usual, with the IPv6<br />
	&nbsp;&nbsp; address on the "interesting ports" line being the only IPv6<br />
	&nbsp;&nbsp; giveaway.<br />
<br />
	&nbsp;&nbsp; While IPv6 hasn't exactly taken the world by storm, it gets<br />
	&nbsp;&nbsp; significant use in some (usually Asian) countries and most modern<br />
	&nbsp;&nbsp; operating systems support it. To use Nmap with IPv6, both the<br />
	&nbsp;&nbsp; source and target of your scan must be configured for IPv6. If your<br />
	&nbsp;&nbsp; ISP (like most of them) does not allocate IPv6 addresses to you,<br />
	&nbsp;&nbsp; free tunnel brokers are widely available and work fine with Nmap. I<br />
	&nbsp;&nbsp; use the free IPv6 tunnel broker.&nbsp;&nbsp;service at<br />
	&nbsp;&nbsp; http://www.tunnelbroker.net. Other tunnel brokers are listed at<br />
	&nbsp;&nbsp; Wikipedia[18]. 6to4 tunnels are another popular, free approach.<br />
<br />
	&nbsp;&nbsp; On Windows, raw-socket IPv6 scans are supported only on ethernet<br />
	&nbsp;&nbsp; devices (not tunnels), and only on Windows Vista.&nbsp;&nbsp;and later. Use<br />
	&nbsp;&nbsp; the --unprivileged.	option in other situations.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -A (Aggressive scan options) .<br />
	&nbsp;&nbsp; This option enables additional advanced and aggressive options. I<br />
	&nbsp;&nbsp; haven't decided exactly which it stands for yet. Presently this<br />
	&nbsp;&nbsp; enables OS detection (-O), version scanning (-sV), script scanning<br />
	&nbsp;&nbsp; (-sC) and traceroute (--traceroute)..&nbsp;&nbsp;More features may be added<br />
	&nbsp;&nbsp; in the future. The point is to enable a comprehensive set of scan<br />
	&nbsp;&nbsp; options without people having to remember a large set of flags.<br />
	&nbsp;&nbsp; However, because script scanning with the default set is considered<br />
	&nbsp;&nbsp; intrusive, you should not use -A against target networks without<br />
	&nbsp;&nbsp; permission. This option only enables features, and not timing<br />
	&nbsp;&nbsp; options (such as -T4) or verbosity options (-v) that you might want<br />
	&nbsp;&nbsp; as well.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --datadir directoryname (Specify custom Nmap data file location) .<br />
	&nbsp;&nbsp; Nmap obtains some special data at runtime in files named<br />
	&nbsp;&nbsp; nmap-service-probes, nmap-services, nmap-protocols, nmap-rpc,<br />
	&nbsp;&nbsp; nmap-mac-prefixes, and nmap-os-db. If the location of any of these<br />
	&nbsp;&nbsp; files has been specified (using the --servicedb or --versiondb<br />
	&nbsp;&nbsp; options), that location is used for that file. After that, Nmap<br />
	&nbsp;&nbsp; searches these files in the directory specified with the --datadir<br />
	&nbsp;&nbsp; option (if any). Any files not found there, are searched for in the<br />
	&nbsp;&nbsp; directory specified by the NMAPDIR.	environment variable. Next<br />
	&nbsp;&nbsp; comes ~/.nmap.&nbsp;&nbsp;for real and effective UIDs; or on Windows,<br />
	&nbsp;&nbsp; HOME\AppData\Roaming\nmap (where HOME is the user's home directory,<br />
	&nbsp;&nbsp; like C:\Users\user). This is followed by the location of the nmap<br />
	&nbsp;&nbsp; executable and the same location with ../share/nmap appended. Then<br />
	&nbsp;&nbsp; a compiled-in location such as /usr/local/share/nmap or<br />
	&nbsp;&nbsp; /usr/share/nmap.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --servicedb services file (Specify custom services file) .<br />
	&nbsp;&nbsp; Asks Nmap to use the specified services file rather than the<br />
	&nbsp;&nbsp; nmap-services data file that comes with Nmap. Using this option<br />
	&nbsp;&nbsp; also causes a fast scan (-F) to be used. See the description for<br />
	&nbsp;&nbsp; --datadir for more information on Nmap's data files.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --versiondb service probes file (Specify custom service probes file) .<br />
	&nbsp;&nbsp; Asks Nmap to use the specified service probes file rather than the<br />
	&nbsp;&nbsp; nmap-service-probes data file that comes with Nmap. See the<br />
	&nbsp;&nbsp; description for --datadir for more information on Nmap's data<br />
	&nbsp;&nbsp; files.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --send-eth (Use raw ethernet sending) .<br />
	&nbsp;&nbsp; Asks Nmap to send packets at the raw ethernet (data link) layer<br />
	&nbsp;&nbsp; rather than the higher IP (network) layer. By default, Nmap chooses<br />
	&nbsp;&nbsp; the one which is generally best for the platform it is running on.<br />
	&nbsp;&nbsp; Raw sockets (IP layer).&nbsp;&nbsp;are generally most efficient for Unix<br />
	&nbsp;&nbsp; machines, while ethernet frames are required for Windows operation<br />
	&nbsp;&nbsp; since Microsoft disabled raw socket support. Nmap still uses raw IP<br />
	&nbsp;&nbsp; packets on Unix despite this option when there is no other choice<br />
	&nbsp;&nbsp; (such as non-ethernet connections).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --send-ip (Send at raw IP level) .<br />
	&nbsp;&nbsp; Asks Nmap to send packets via raw IP sockets rather than sending<br />
	&nbsp;&nbsp; lower level ethernet frames. It is the complement to the --send-eth<br />
	&nbsp;&nbsp; option discussed previously.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --privileged (Assume that the user is fully privileged) .<br />
	&nbsp;&nbsp; Tells Nmap to simply assume that it is privileged enough to perform<br />
	&nbsp;&nbsp; raw socket sends, packet sniffing, and similar operations that<br />
	&nbsp;&nbsp; usually require root privileges.&nbsp;&nbsp;on Unix systems. By default Nmap<br />
	&nbsp;&nbsp; quits if such operations are requested but geteuid is not zero.<br />
	&nbsp;&nbsp; --privileged is useful with Linux kernel capabilities and similar<br />
	&nbsp;&nbsp; systems that may be configured to allow unprivileged users to<br />
	&nbsp;&nbsp; perform raw-packet scans. Be sure to provide this option flag<br />
	&nbsp;&nbsp; before any flags for options that require privileges (SYN scan, OS<br />
	&nbsp;&nbsp; detection, etc.). The NMAP_PRIVILEGED.&nbsp;&nbsp;environment variable may be<br />
	&nbsp;&nbsp; set as an equivalent alternative to --privileged.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --unprivileged (Assume that the user lacks raw socket privileges) .<br />
	&nbsp;&nbsp; This option is the opposite of --privileged. It tells Nmap to treat<br />
	&nbsp;&nbsp; the user as lacking network raw socket and sniffing privileges.<br />
	&nbsp;&nbsp; This is useful for testing, debugging, or when the raw network<br />
	&nbsp;&nbsp; functionality of your operating system is somehow broken. The<br />
	&nbsp;&nbsp; NMAP_UNPRIVILEGED.&nbsp;&nbsp;environment variable may be set as an<br />
	&nbsp;&nbsp; equivalent alternative to --unprivileged.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --release-memory (Release memory before quitting) .<br />
	&nbsp;&nbsp; This option is only useful for memory-leak debugging. It causes<br />
	&nbsp;&nbsp; Nmap to release allocated memory just before it quits so that<br />
	&nbsp;&nbsp; actual memory leaks are easier to spot. Normally Nmap skips this as<br />
	&nbsp;&nbsp; the OS does this anyway upon process termination.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -V; --version (Print version number) .<br />
	&nbsp;&nbsp; Prints the Nmap version number and exits.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -h; --help (Print help summary page) .<br />
	&nbsp;&nbsp; Prints a short help screen with the most common command flags.<br />
	&nbsp;&nbsp; Running Nmap without any arguments does the same thing.<br />
<br />
RUNTIME INTERACTION<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; During the execution of Nmap, all key presses are captured. This allows<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; you to interact with the program without aborting and restarting it.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Certain special keys will change options, while any other keys will<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print out a status message telling you about the scan. The convention<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is that lowercase letters increase the amount of printing, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uppercase letters decrease the printing. You may also press ? for<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; help.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v / V<br />
	&nbsp;&nbsp; Increase / decrease the verbosity level<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d / D<br />
	&nbsp;&nbsp; Increase / decrease the debugging Level<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p / P<br />
	&nbsp;&nbsp; Turn on / off packet tracing<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ?<br />
	&nbsp;&nbsp; Print a runtime interaction help screen<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Anything else<br />
	&nbsp;&nbsp; Print out a status message like this:<br />
<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Stats: 0:00:07 elapsed; 20 hosts completed (1 up), 1 undergoing Service Scan<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Service scan Timing: About 33.33% done; ETC: 20:57 (0:00:12 remaining)<br />
<br />
EXAMPLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Here are some Nmap usage examples, from the simple and routine to a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; little more complex and esoteric. Some actual IP addresses and domain<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; names are used to make things more concrete. In their place you should<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; substitute addresses/names from your own network. While I don't think<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; port scanning other networks is or should be illegal, some network<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; administrators don't appreciate unsolicited scanning of their networks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and may complain. Getting permission first is the best approach.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For testing purposes, you have permission to scan the host<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanme.nmap.org..&nbsp;&nbsp;This permission only includes scanning via Nmap and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; not testing exploits or denial of service attacks. To conserve<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bandwidth, please do not initiate more than a dozen scans against that<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; host per day. If this free scanning target service is abused, it will<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; be taken down and Nmap will report Failed to resolve given hostname/IP:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanme.nmap.org. These permissions also apply to the hosts<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanme2.nmap.org, scanme3.nmap.org, and so on, though those hosts do<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; not currently exist.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This option scans all reserved TCP ports on the machine scanme.nmap.org<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; . The -v option enables verbose mode.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Launches a stealth SYN scan against each machine that is up out of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 256 IPs on the class C sized network where Scanme resides. It also<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tries to determine what operating system is running on each host that<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is up and running. This requires root privileges because of the SYN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scan and OS detection.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Launches host enumeration and a TCP scan at the first half of each of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the 255 possible eight-bit subnets in the 198.116 class B address<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; space. This tests whether the systems run SSH, DNS, POP3, or IMAP on<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; their standard ports, or anything on port 4564. For any of these ports<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; found open, version detection is used to determine what application is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; running.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Asks Nmap to choose 100,000 hosts at random and scan them for web<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; servers (port 80). Host enumeration is disabled with -Pn since first<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sending a couple probes to determine whether a host is up is wasteful<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when you are only probing one port on each target host anyway.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This scans 4096 IPs for any web servers (without pinging them) and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; saves the output in grepable and XML formats.<br />
<br />
NMAP BOOK<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While this reference guide details all material Nmap options, it can't<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fully demonstrate how to apply those features to quickly solve<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; real-world tasks. For that, we released Nmap Network Scanning: The<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Official Nmap Project Guide to Network Discovery and Security Scanning.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Topics include subverting firewalls and intrusion detection systems,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; optimizing Nmap performance, and automating common networking tasks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; with the Nmap Scripting Engine. Hints and instructions are provided for<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; common Nmap tasks such as taking network inventory, penetration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; testing, detecting rogue wireless access points, and quashing network<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; worm outbreaks. Examples and diagrams show actual communication on the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wire. More than half of the book is available free online. See<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://nmap.org/book for more information.<br />
<br />
BUGS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Like its author, Nmap isn't perfect. But you can help make it better by<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sending bug reports or even writing patches. If Nmap doesn't behave the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; way you expect, first upgrade to the latest version available from<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://nmap.org. If the problem persists, do some research to determine<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; whether it has already been discovered and addressed. Try searching for<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the error message on our search page at http://insecure.org/search.html<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or at Google. Also try browsing the nmap-dev archives at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://seclists.org/..&nbsp;&nbsp;Read this full manual page as well. If nothing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; comes of this, mail a bug report to &lt;dev@nmap.org&gt;. Please include<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; everything you have learned about the problem, as well as what version<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; of Nmap you are running and what operating system version it is running<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; on. Problem reports and Nmap usage questions sent to &lt;dev@nmap.org&gt; are<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; far more likely to be answered than those sent to Fyodor directly. If<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; you subscribe to the nmap-dev list before posting, your message will<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bypass moderation and get through more quickly. Subscribe at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://nmap.org/mailman/listinfo/dev.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Code patches to fix bugs are even better than bug reports. Basic<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; instructions for creating patch files with your changes are available<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at https://svn.nmap.org/nmap/HACKING. Patches may be sent to nmap-dev<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (recommended) or to Fyodor directly.<br />
<br />
AUTHOR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Gordon "Fyodor" Lyon &lt;fyodor@nmap.org&gt; (http://insecure.org)<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Hundreds of people have made valuable contributions to Nmap over the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; years. These are detailed in the CHANGELOG.&nbsp;&nbsp;file which is distributed<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; with Nmap and also available from http://nmap.org/changelog.html.<br />
<br />
LEGAL NOTICES<br />
&nbsp;&nbsp; Nmap Copyright and Licensing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Nmap Security Scanner is (C) 19962012 Insecure.Com LLC. Nmap is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; also a registered trademark of Insecure.Com LLC. This program is free<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; software; you may redistribute and/or modify it under the terms of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GNU General Public License as published by the Free Software<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foundation; Version 2 with the clarifications and exceptions described<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; below. This guarantees your right to use, modify, and redistribute this<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; software under certain conditions. If you wish to embed Nmap technology<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; into proprietary software, we sell alternative licenses (contact<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;sales@insecure.com&gt;). Dozens of software vendors already license Nmap<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; technology such as host discovery, port scanning, OS detection, and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version detection.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Note that the GPL places important restrictions on "derived works", yet<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; it does not provide a detailed definition of that term. To avoid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; misunderstandings, we consider an application to constitute a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "derivative work" for the purpose of this license if it does any of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; following:<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &middot;&nbsp;&nbsp; Integrates source code from Nmap<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &middot;&nbsp;&nbsp; Reads or includes Nmap copyrighted data files, such as nmap-os-db<br />
	&nbsp;&nbsp; or nmap-service-probes.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &middot;&nbsp;&nbsp; Executes Nmap and parses the results (as opposed to typical shell<br />
	&nbsp;&nbsp; or execution-menu apps, which simply display raw Nmap output and so<br />
	&nbsp;&nbsp; are not derivative works.)<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &middot;&nbsp;&nbsp; Integrates/includes/aggregates Nmap into a proprietary executable<br />
	&nbsp;&nbsp; installer, such as those produced by InstallShield.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &middot;&nbsp;&nbsp; Links to a library or executes a program that does any of the<br />
	&nbsp;&nbsp; above.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The term "Nmap" should be taken to also include any portions or derived<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; works of Nmap. This list is not exclusive, but is meant to clarify our<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; interpretation of derived works with some common examples. Our<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; interpretation applies only to Nmapwe don't speak for other people's<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GPL works.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If you have any questions about the GPL licensing restrictions on using<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap in non-GPL works, we would be happy to help. As mentioned above,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; we also offer alternative license to integrate Nmap into proprietary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; applications and appliances. These contracts have been sold to many<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; security vendors, and generally include a perpetual license as well as<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; providing for priority support and updates as well as helping to fund<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the continued development of Nmap technology. Please email<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;sales@insecure.com&gt; for further information.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; As a special exception to the GPL terms, Insecure.Com LLC grants<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; permission to link the code of this program with any version of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OpenSSL library which is distributed under a license identical to that<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; listed in the included COPYING.OpenSSL file, and distribute linked<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; combinations including the two..	 You must obey the GNU GPL in all<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; respects for all of the code used other than OpenSSL. If you modify<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this file, you may extend this exception to your version of the file,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; but you are not obligated to do so.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If you received these files with a written license agreement or<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contract stating terms other than the terms above, then that<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alternative license agreement takes precedence over these comments.<br />
<br />
&nbsp;&nbsp; Creative Commons License for this Nmap Guide<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This Nmap Reference Guide is (C) 20052012 Insecure.Com LLC. It is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hereby placed under version 3.0 of the Creative Commons Attribution<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; License[19]. This allows you redistribute and modify the work as you<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; desire, as long as you credit the original source. Alternatively, you<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; may choose to treat this document as falling under the same license as<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap itself (discussed previously).<br />
<br />
&nbsp;&nbsp; Source Code Availability and Community Contributions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source is provided to this software because we believe users have a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; right to know exactly what a program is going to do before they run it.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This also allows you to audit the software for security holes (none<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; have been found so far).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source code also allows you to port Nmap to new platforms, fix bugs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and add new features. You are highly encouraged to send your changes to<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;dev@nmap.org&gt; for possible incorporation into the main distribution.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; By sending these changes to Fyodor or one of the Insecure.Org<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; development mailing lists, it is assumed that you are offering the Nmap<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Project (Insecure.Com LLC) the unlimited, non-exclusive right to reuse,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; modify, and relicense the code. Nmap will always be available open<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; source,.	 but this is important because the inability to relicense code<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; has caused devastating problems for other Free Software projects (such<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; as KDE and NASM). We also occasionally relicense the code to third<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parties as discussed above. If you wish to specify special license<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conditions of your contributions, just say so when you send them.<br />
<br />
&nbsp;&nbsp; No Warranty.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This program is distributed in the hope that it will be useful, but<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WITHOUT ANY WARRANTY; without even the implied warranty of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; General Public License v2.0 for more details at<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://www.gnu.org/licenses/gpl-2.0.html, or in the COPYING file<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; included with Nmap.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; It should also be noted that Nmap has occasionally been known to crash<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; poorly written applications, TCP/IP stacks, and even operating<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; systems..&nbsp;&nbsp;While this is extremely rare, it is important to keep in<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mind.&nbsp;&nbsp;Nmap should never be run against mission critical systems unless<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; you are prepared to suffer downtime. We acknowledge here that Nmap may<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crash your systems or networks and we disclaim all liability for any<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; damage or problems Nmap could cause.<br />
<br />
&nbsp;&nbsp; Inappropriate Usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Because of the slight risk of crashes and because a few black hats like<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to use Nmap for reconnaissance prior to attacking systems, there are<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; administrators who become upset and may complain when their system is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scanned. Thus, it is often advisable to request permission before doing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; even a light scan of a network.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap should never be installed with special privileges (e.g. suid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root)..	That would open up a major security vulnerability as other<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; users on the system (or attackers) could use it for privilege<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; escalation.<br />
<br />
&nbsp;&nbsp; Third-Party Software and Funding Notices<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This product includes software developed by the Apache Software<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Foundation[20]. A modified version of the Libpcap portable packet<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; capture library[21].&nbsp;&nbsp;is distributed along with Nmap. The Windows<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version of Nmap utilized the Libpcap-derived WinPcap library[22].<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; instead. Regular expression support is provided by the PCRE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; library[23],.&nbsp;&nbsp;which is open-source software, written by Philip Hazel..<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Certain raw networking functions use the Libdnet[24].&nbsp;&nbsp;networking<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; library, which was written by Dug Song..	 A modified version is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; distributed with Nma.p Nmap can optionally link with the OpenSSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cryptography toolkit[25].&nbsp;&nbsp;for SSL version detection support. The Nmap<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Scripting Engine uses an embedded version of the Lua programming<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; language[26]..&nbsp;&nbsp;The Liblinear linear classification library[27] is used<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for our IPv6 OS detection machine learning techniques[28].&nbsp;&nbsp;All of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; third-party software described in this paragraph is freely<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; redistributable under BSD-style software licenses.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Binary packages for Windows and Mac OS X include support libraries<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; necessary to run Zenmap and Ndiff with Python and PyGTK. (Unix<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; platforms commonly make these libraries easy to install, so they are<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; not part of the packages.) A listing of these support libraries and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; their licenses is included in the LICENSES files.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This software was supported in part through the Google Summer of<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Code[29] and the DARPA CINDER program[30] (DARPA-BAA-10-84).<br />
<br />
&nbsp;&nbsp; United States Export Control.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nmap only uses encryption when compiled with the optional OpenSSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; support and linked with OpenSSL. When compiled without OpenSSL support,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Insecure.Com LLC believes that Nmap is not subject to U.S.&nbsp;&nbsp;Export<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Administration Regulations (EAR)[31] export control. As such, there is<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; no applicable ECCN (export control classification number) and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exportation does not require any special license, permit, or other<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; governmental authorization.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; When compiled with OpenSSL support or distributed as source code,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Insecure.Com LLC believes that Nmap falls under U.S. ECCN 5D002[32]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ("Information Security Software"). We distribute Nmap under the TSU<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exception for publicly available encryption software defined in EAR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 740.13(e)[33].<br />
<br />
NOTES<br />
	1. Nmap Network Scanning: The Official Nmap Project Guide to Network<br />
	&nbsp;&nbsp; Discovery and Security Scanning<br />
	&nbsp;&nbsp; http://nmap.org/book/<br />
<br />
	2. RFC 1122<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc1122.txt<br />
<br />
	3. RFC 792<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc792.txt<br />
<br />
	4. RFC 950<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc950.txt<br />
<br />
	5. RFC 1918<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc1918.txt<br />
<br />
	6. UDP<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc768.txt<br />
<br />
	7. SCTP<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc4960.txt<br />
<br />
	8. TCP RFC<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc793.txt<br />
<br />
	9. RFC 959<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc959.txt<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10. RFC 1323<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc1323.txt<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 11. Lua programming language<br />
	&nbsp;&nbsp; http://lua.org<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 12. precedence<br />
	&nbsp;&nbsp; http://www.lua.org/manual/5.1/manual.html#2.5.3<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 13. IP protocol<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc791.txt<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 14. RFC 2960<br />
	&nbsp;&nbsp; http://www.rfc-editor.org/rfc/rfc2960.txt<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 15. Nmap::Scanner<br />
	&nbsp;&nbsp; http://sourceforge.net/projects/nmap-scanner/<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 16. Nmap::Parser<br />
	&nbsp;&nbsp; http://nmapparser.wordpress.com/<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 17. xsltproc<br />
	&nbsp;&nbsp; http://xmlsoft.org/XSLT/<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 18. listed at Wikipedia<br />
	&nbsp;&nbsp; http://en.wikipedia.org/wiki/List_of_IPv6_tunnel_brokers<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 19. Creative Commons Attribution License<br />
	&nbsp;&nbsp; http://creativecommons.org/licenses/by/3.0/<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20. Apache Software Foundation<br />
	&nbsp;&nbsp; http://www.apache.org<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 21. Libpcap portable packet capture library<br />
	&nbsp;&nbsp; http://www.tcpdump.org<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 22. WinPcap library<br />
	&nbsp;&nbsp; http://www.winpcap.org<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 23. PCRE library<br />
	&nbsp;&nbsp; http://www.pcre.org<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 24. Libdnet<br />
	&nbsp;&nbsp; http://libdnet.sourceforge.net<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 25. OpenSSL cryptography toolkit<br />
	&nbsp;&nbsp; http://www.openssl.org<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 26. Lua programming language<br />
	&nbsp;&nbsp; http://www.lua.org<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 27. Liblinear linear classification library<br />
	&nbsp;&nbsp; http://www.csie.ntu.edu.tw/~cjlin/liblinear/<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 28. IPv6 OS detection machine learning techniques<br />
	&nbsp;&nbsp; http://nmap.org/book/osdetect-guess.html#osdetect-guess-ipv6<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 29. Google Summer of Code<br />
	&nbsp;&nbsp; http://nmap.org/soc/<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30. DARPA CINDER program<br />
	&nbsp;&nbsp; https://www.fbo.gov/index?s=opportunity&amp;mode=form&amp;id=585e02a51f77af5cb3c9e06b9cc82c48&amp;tab=core&amp;_cview=1<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 31. Export Administration Regulations (EAR)<br />
	&nbsp;&nbsp; http://www.access.gpo.gov/bis/ear/ear_data.html<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 32. 5D002<br />
	&nbsp;&nbsp; http://www.access.gpo.gov/bis/ear/pdf/ccl5-pt2.pdf<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 33. EAR 740.13(e)<br />
	&nbsp;&nbsp; http://www.access.gpo.gov/bis/ear/pdf/740.pdf<br />
<br />
<br />
<br />
Nmap				&nbsp;&nbsp;07/28/2013			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NMAP(1)<br />
